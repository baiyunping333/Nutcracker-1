<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nutcracker: states.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script src="http://www.mathjax.org/mathjax/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nutcracker</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>states.hpp</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//@+leo-ver=5-thin</span>
<a name="l00002"></a>00002 <span class="comment">//@+node:gcross.20110213161858.1810: * @file states.hpp</span>
<a name="l00003"></a>00003 <span class="comment">//@@language cplusplus</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="comment">//@+&lt;&lt; License &gt;&gt;</span>
<a name="l00006"></a>00006 <span class="comment">//@+node:gcross.20110220182654.2018: ** &lt;&lt; License &gt;&gt;</span>
<a name="l00007"></a>00007 <span class="comment">//@+at</span>
<a name="l00008"></a>00008 <span class="comment">// Copyright (c) 2011, Gregory Crosswhite</span>
<a name="l00009"></a>00009 <span class="comment">// All rights reserved.</span>
<a name="l00010"></a>00010 <span class="comment">// </span>
<a name="l00011"></a>00011 <span class="comment">// Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00012"></a>00012 <span class="comment">// </span>
<a name="l00013"></a>00013 <span class="comment">//     * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00014"></a>00014 <span class="comment">//     * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00015"></a>00015 <span class="comment">// </span>
<a name="l00016"></a>00016 <span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00017"></a>00017 <span class="comment">//@@c</span>
<a name="l00018"></a>00018 <span class="comment">//@-&lt;&lt; License &gt;&gt;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#ifndef NUTCRACKER_STATES_HPP</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor">#define NUTCRACKER_STATES_HPP</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00023"></a>00023 <span class="comment">//@+&lt;&lt; Includes &gt;&gt;</span>
<a name="l00024"></a>00024 <span class="comment">//@+node:gcross.20110213161858.1811: ** &lt;&lt; Includes &gt;&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;boost/concept_check.hpp&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;boost/container/vector.hpp&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;boost/iterator/zip_iterator.hpp&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;boost/range/concepts.hpp&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;boost/tuple/tuple.hpp&gt;</span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="boundaries_8hpp.html" title="Functions related to boundaries.">boundaries.hpp</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="core_8hpp.html" title="Core numeric kernels.">core.hpp</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="flat_8hpp.html" title="Classes and functions relating to flat representations of states.">flat.hpp</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;tensors.hpp&quot;</span>
<a name="l00035"></a>00035 <span class="comment">//@-&lt;&lt; Includes &gt;&gt;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="keyword">namespace </span>Nutcracker {
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="comment">//@+&lt;&lt; Usings &gt;&gt;</span>
<a name="l00040"></a>00040 <span class="comment">//@+node:gcross.20110213161858.1812: ** &lt;&lt; Usings &gt;&gt;</span>
<a name="l00041"></a>00041 <span class="keyword">using</span> boost::container::vector;
<a name="l00042"></a>00042 <span class="keyword">using</span> boost::make_tuple;
<a name="l00043"></a>00043 <span class="keyword">using</span> boost::make_zip_iterator;
<a name="l00044"></a>00044 <span class="keyword">using</span> boost::SinglePassRangeConcept;
<a name="l00045"></a>00045 <span class="keyword">using</span> boost::tuple;
<a name="l00046"></a>00046 <span class="comment">//@-&lt;&lt; Usings &gt;&gt;</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="comment">//@+others</span>
<a name="l00049"></a>00049 <span class="comment">//@+node:gcross.20110214155808.1966: ** Exceptions</span>
<a name="l00050"></a>00050 <span class="comment">//@+node:gcross.20110214155808.1967: *3* NormalizationError</span>
<a name="l00051"></a><a class="code" href="structNutcracker_1_1NormalizationError.html">00051</a> <span class="keyword">struct </span><a class="code" href="structNutcracker_1_1NormalizationError.html">NormalizationError</a> : <span class="keyword">public</span> <a class="code" href="structNutcracker_1_1Exception.html" title="A convenient base class for exceptions.">Exception</a> {
<a name="l00052"></a>00052     <span class="keywordtype">int</span> <span class="keyword">const</span> info;
<a name="l00053"></a>00053     <a class="code" href="structNutcracker_1_1NormalizationError.html">NormalizationError</a>(<span class="keywordtype">int</span> info);
<a name="l00054"></a>00054 };
<a name="l00055"></a>00055 <span class="comment">//@+node:gcross.20110214155808.1968: *3* NotEnoughDegreesOfFreedomToNormalizeError</span>
<a name="l00056"></a><a class="code" href="structNutcracker_1_1NotEnoughDegreesOfFreedomToNormalizeError.html">00056</a> <span class="keyword">struct </span><a class="code" href="structNutcracker_1_1NotEnoughDegreesOfFreedomToNormalizeError.html">NotEnoughDegreesOfFreedomToNormalizeError</a> : <span class="keyword">public</span> <a class="code" href="structNutcracker_1_1Exception.html" title="A convenient base class for exceptions.">Exception</a> {
<a name="l00057"></a>00057     <span class="keywordtype">string</span> n1, n2, n3;
<a name="l00058"></a>00058     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d1, d2, d3;
<a name="l00059"></a>00059     <a class="code" href="structNutcracker_1_1NotEnoughDegreesOfFreedomToNormalizeError.html">NotEnoughDegreesOfFreedomToNormalizeError</a>(
<a name="l00060"></a>00060          <span class="keywordtype">string</span> <span class="keyword">const</span>&amp; n1
<a name="l00061"></a>00061         ,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> d1
<a name="l00062"></a>00062         ,<span class="keywordtype">string</span> <span class="keyword">const</span>&amp; n2
<a name="l00063"></a>00063         ,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> d2
<a name="l00064"></a>00064         ,<span class="keywordtype">string</span> <span class="keyword">const</span>&amp; n3
<a name="l00065"></a>00065         ,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> d3
<a name="l00066"></a>00066     ) : <a class="code" href="structNutcracker_1_1Exception.html#aa48c661e5e346938f3fe2d71eb9e9726" title="The message to be stored in this exception.">Exception</a>((
<a name="l00067"></a>00067             format(<span class="stringliteral">&quot;Not enough degrees of freedom to normalize (%1% (%2%) &gt; %3% (%4%) * %5% (%6%))&quot;</span>)
<a name="l00068"></a>00068                 % n1
<a name="l00069"></a>00069                 % d1
<a name="l00070"></a>00070                 % n2
<a name="l00071"></a>00071                 % d2
<a name="l00072"></a>00072                 % n3
<a name="l00073"></a>00073                 % d3
<a name="l00074"></a>00074         ).str())
<a name="l00075"></a>00075       , n1(n1)
<a name="l00076"></a>00076       , n2(n2)
<a name="l00077"></a>00077       , n3(n3)
<a name="l00078"></a>00078       , d1(d1)
<a name="l00079"></a>00079       , d2(d2)
<a name="l00080"></a>00080       , d3(d3)
<a name="l00081"></a>00081     { }
<a name="l00082"></a>00082     <span class="keyword">virtual</span> ~<a class="code" href="structNutcracker_1_1NotEnoughDegreesOfFreedomToNormalizeError.html">NotEnoughDegreesOfFreedomToNormalizeError</a>() <span class="keywordflow">throw</span>() {}
<a name="l00083"></a>00083 };
<a name="l00084"></a>00084 <span class="comment">//@+node:gcross.20110213233103.2762: ** Classes</span>
<a name="l00085"></a>00085 <span class="comment">//@+node:gcross.20110213233103.2763: *3* IncreaseDimensionBetweenResult</span>
<a name="l00086"></a><a class="code" href="classNutcracker_1_1IncreaseDimensionBetweenResult.html">00086</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> s<span class="keywordtype">id</span>e1,<span class="keyword">typename</span> s<span class="keywordtype">id</span>e2&gt; <span class="keyword">class </span><a class="code" href="classNutcracker_1_1IncreaseDimensionBetweenResult.html">IncreaseDimensionBetweenResult</a> {
<a name="l00087"></a>00087 <span class="keyword">private</span>:
<a name="l00088"></a>00088     BOOST_MOVABLE_BUT_NOT_COPYABLE(<a class="code" href="classNutcracker_1_1IncreaseDimensionBetweenResult.html">IncreaseDimensionBetweenResult</a>)
<a name="l00089"></a>00089 <span class="keyword">public</span>:
<a name="l00090"></a>00090     <a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;side1&gt;</a> state_site_1;
<a name="l00091"></a>00091     <a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;side2&gt;</a> state_site_2;
<a name="l00092"></a>00092 
<a name="l00093"></a>00093     <a class="code" href="classNutcracker_1_1IncreaseDimensionBetweenResult.html">IncreaseDimensionBetweenResult</a>(BOOST_RV_REF(<a class="code" href="classNutcracker_1_1IncreaseDimensionBetweenResult.html">IncreaseDimensionBetweenResult</a>) other)
<a name="l00094"></a>00094       : state_site_1(boost::move(other.state_site_1))
<a name="l00095"></a>00095       , state_site_2(boost::move(other.state_site_2))
<a name="l00096"></a>00096     {}
<a name="l00097"></a>00097 
<a name="l00098"></a>00098     <a class="code" href="classNutcracker_1_1IncreaseDimensionBetweenResult.html">IncreaseDimensionBetweenResult</a>(
<a name="l00099"></a>00099           BOOST_RV_REF(<a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;side1&gt;</a>) state_site_1
<a name="l00100"></a>00100         , BOOST_RV_REF(<a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;side2&gt;</a>) state_site_2
<a name="l00101"></a>00101     ) : state_site_1(state_site_1)
<a name="l00102"></a>00102       , state_site_2(state_site_2)
<a name="l00103"></a>00103     {}
<a name="l00104"></a>00104 };
<a name="l00105"></a>00105 <span class="comment">//@+node:gcross.20110213233103.2764: *3* MoveSiteCursorResult</span>
<a name="l00106"></a><a class="code" href="classNutcracker_1_1MoveSiteCursorResult.html">00106</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> s<span class="keywordtype">id</span>e&gt; <span class="keyword">class </span><a class="code" href="classNutcracker_1_1MoveSiteCursorResult.html">MoveSiteCursorResult</a> {
<a name="l00107"></a>00107 <span class="keyword">private</span>:
<a name="l00108"></a>00108     BOOST_MOVABLE_BUT_NOT_COPYABLE(<a class="code" href="classNutcracker_1_1MoveSiteCursorResult.html">MoveSiteCursorResult</a>)
<a name="l00109"></a>00109     <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structNutcracker_1_1Other.html">Other&lt;side&gt;::value</a> other_side;
<a name="l00110"></a>00110 <span class="keyword">public</span>:
<a name="l00111"></a>00111     <a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Middle&gt;</a> middle_state_site;
<a name="l00112"></a>00112     <a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;other_side&gt;</a> other_side_state_site;
<a name="l00113"></a>00113 
<a name="l00114"></a>00114     <a class="code" href="classNutcracker_1_1MoveSiteCursorResult.html">MoveSiteCursorResult</a>(BOOST_RV_REF(<a class="code" href="classNutcracker_1_1MoveSiteCursorResult.html">MoveSiteCursorResult</a>) other)
<a name="l00115"></a>00115       : middle_state_site(boost::move(other.middle_state_site))
<a name="l00116"></a>00116       , other_side_state_site(boost::move(other.other_side_state_site))
<a name="l00117"></a>00117     {}
<a name="l00118"></a>00118 
<a name="l00119"></a>00119     <a class="code" href="classNutcracker_1_1MoveSiteCursorResult.html">MoveSiteCursorResult</a>(
<a name="l00120"></a>00120           BOOST_RV_REF(<a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Middle&gt;</a>) middle_state_site
<a name="l00121"></a>00121         , BOOST_RV_REF(<a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;other_side&gt;</a>) other_side_state_site
<a name="l00122"></a>00122     ) : middle_state_site(middle_state_site)
<a name="l00123"></a>00123       , other_side_state_site(other_side_state_site)
<a name="l00124"></a>00124     {}
<a name="l00125"></a>00125 };
<a name="l00126"></a>00126 <span class="comment">//@+node:gcross.20110430223656.2179: *3* State</span>
<a name="l00127"></a>00127 <span class="comment">//@+&lt;&lt; Description &gt;&gt;</span>
<a name="l00128"></a>00128 <span class="comment">//@+node:gcross.20110430223656.2180: *4* &lt;&lt; Description &gt;&gt;</span>
<a name="l00130"></a>00130 <span class="comment"></span>
<a name="l00135"></a>00135 <span class="comment">//@-&lt;&lt; Description &gt;&gt;</span>
<a name="l00136"></a><a class="code" href="structNutcracker_1_1State.html">00136</a> <span class="keyword">struct </span><a class="code" href="structNutcracker_1_1State.html" title="Matrix product state in canonical form.">State</a> {
<a name="l00137"></a>00137     <span class="comment">//@+others</span>
<a name="l00138"></a>00138     <span class="comment">//@+node:gcross.20110430223656.2181: *4* [Move support]</span>
<a name="l00139"></a>00139     <span class="keyword">private</span>:
<a name="l00140"></a>00140 
<a name="l00141"></a>00141     BOOST_MOVABLE_BUT_NOT_COPYABLE(<a class="code" href="structNutcracker_1_1State.html" title="Matrix product state in canonical form.">State</a>)
<a name="l00142"></a>00142     <span class="comment">//@+node:gcross.20110430223656.2182: *4* Assignment</span>
<a name="l00143"></a>00143     <span class="keyword">public</span>:
<a name="l00144"></a>00144 
<a name="l00146"></a><a class="code" href="structNutcracker_1_1State.html#a9245f8a2204632953d3cda7f988ed760">00146</a>     <span class="keywordtype">void</span> <a class="code" href="structNutcracker_1_1State.html#a9245f8a2204632953d3cda7f988ed760" title="Moves the matrix product state contained in other to this and invalidates other.">operator=</a>(BOOST_RV_REF(<a class="code" href="structNutcracker_1_1State.html" title="Matrix product state in canonical form.">State</a>) other) {
<a name="l00147"></a>00147         <a class="code" href="structNutcracker_1_1State.html#a3f84a6bf1065a114216f8ab49e5a17f3" title="The left-most site in the matrix product state.">first_site</a> = boost::move(other.<a class="code" href="structNutcracker_1_1State.html#a3f84a6bf1065a114216f8ab49e5a17f3" title="The left-most site in the matrix product state.">first_site</a>);
<a name="l00148"></a>00148         <a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a> = boost::move(other.<a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>);
<a name="l00149"></a>00149     }
<a name="l00150"></a>00150 
<a name="l00152"></a><a class="code" href="structNutcracker_1_1State.html#a95ace3b15bc17209666fb9e142b38f32">00152</a>     <span class="keywordtype">void</span> <a class="code" href="structNutcracker_1_1State.html#a95ace3b15bc17209666fb9e142b38f32" title="Swaps the matrix product state contained in other and this.">swap</a>(<a class="code" href="structNutcracker_1_1State.html" title="Matrix product state in canonical form.">State</a>&amp; other) {
<a name="l00153"></a>00153         <a class="code" href="structNutcracker_1_1State.html#a3f84a6bf1065a114216f8ab49e5a17f3" title="The left-most site in the matrix product state.">first_site</a>.<a class="code" href="classNutcracker_1_1StateSite.html#abb40ac4e828294b97549eeec90c93356" title="Swaps the data (and dimensions) in other and this.">swap</a>(other.<a class="code" href="structNutcracker_1_1State.html#a3f84a6bf1065a114216f8ab49e5a17f3" title="The left-most site in the matrix product state.">first_site</a>);
<a name="l00154"></a>00154         <a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>.swap(other.<a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>);
<a name="l00155"></a>00155     }
<a name="l00156"></a>00156     <span class="comment">//@+node:gcross.20110430223656.2183: *4* Constructors</span>
<a name="l00158"></a>00158 <span class="comment"></span>
<a name="l00159"></a>00159     <span class="keyword">public</span>:
<a name="l00160"></a>00160 
<a name="l00162"></a><a class="code" href="structNutcracker_1_1State.html#a976ab0473cc519157536655be0373e42">00162</a>     <a class="code" href="structNutcracker_1_1State.html#a976ab0473cc519157536655be0373e42" title="Construct an invalid matrix product state (presumably into which you will eventually move data from e...">State</a>() {}
<a name="l00163"></a>00163 
<a name="l00165"></a><a class="code" href="structNutcracker_1_1State.html#a57cdad441a38c05ef317a18a1be0e287">00165</a>     <a class="code" href="structNutcracker_1_1State.html#a976ab0473cc519157536655be0373e42" title="Construct an invalid matrix product state (presumably into which you will eventually move data from e...">State</a>(BOOST_RV_REF(<a class="code" href="structNutcracker_1_1State.html" title="Matrix product state in canonical form.">State</a>) other)
<a name="l00166"></a>00166       : <a class="code" href="structNutcracker_1_1State.html#a3f84a6bf1065a114216f8ab49e5a17f3" title="The left-most site in the matrix product state.">first_site</a>(boost::move(other.<a class="code" href="structNutcracker_1_1State.html#a3f84a6bf1065a114216f8ab49e5a17f3" title="The left-most site in the matrix product state.">first_site</a>))
<a name="l00167"></a>00167       , <a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>(boost::move(other.<a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>))
<a name="l00168"></a>00168     {}
<a name="l00169"></a>00169 
<a name="l00171"></a>00171 
<a name="l00175"></a><a class="code" href="structNutcracker_1_1State.html#ab61a5d3afcfa27060a1c73860180467d">00175</a>     <a class="code" href="structNutcracker_1_1State.html#a976ab0473cc519157536655be0373e42" title="Construct an invalid matrix product state (presumably into which you will eventually move data from e...">State</a>(
<a name="l00176"></a>00176           BOOST_RV_REF(<a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Middle&gt;</a>) <a class="code" href="structNutcracker_1_1State.html#a3f84a6bf1065a114216f8ab49e5a17f3" title="The left-most site in the matrix product state.">first_site</a>
<a name="l00177"></a>00177         , BOOST_RV_REF(vector&lt;<a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Right&gt;</a> &gt;) <a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>
<a name="l00178"></a>00178     ) : first_site(first_site)
<a name="l00179"></a>00179       , <a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>(<a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>)
<a name="l00180"></a>00180     { }
<a name="l00181"></a>00181     <span class="comment">//@+node:gcross.20110430223656.2184: *4* Fields</span>
<a name="l00182"></a>00182     <span class="keyword">protected</span>:
<a name="l00183"></a>00183 
<a name="l00185"></a><a class="code" href="structNutcracker_1_1State.html#a3f84a6bf1065a114216f8ab49e5a17f3">00185</a>     <a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Middle&gt;</a> <a class="code" href="structNutcracker_1_1State.html#a3f84a6bf1065a114216f8ab49e5a17f3" title="The left-most site in the matrix product state.">first_site</a>;
<a name="l00186"></a>00186 
<a name="l00188"></a><a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111">00188</a>     vector&lt;StateSite&lt;Right&gt; &gt; <a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>;
<a name="l00189"></a>00189     <span class="comment">//@+node:gcross.20110511112955.2212: *4* Flattening</span>
<a name="l00194"></a>00194 <span class="comment"></span>
<a name="l00195"></a>00195 
<a name="l00196"></a>00196     <span class="keyword">public</span>:
<a name="l00197"></a>00197 
<a name="l00199"></a>00199 
<a name="l00202"></a><a class="code" href="structNutcracker_1_1State.html#aa257289aa5ca269b0479df0f72863450">00202</a>     <a class="code" href="group__Flat.html#ga09e050b6f1b36ee3e2225138d48cf76d" title="The flat representation of quantum states.">StateVector</a> <a class="code" href="structNutcracker_1_1State.html#aa257289aa5ca269b0479df0f72863450" title="Computes the flat vector representation of this state.">computeVector</a>() {
<a name="l00203"></a>00203         <span class="keywordflow">return</span> <a class="code" href="group__Flat.html#ga987f6f1c9842c5be4858f272a6daba0e" title="Computes a flat state vector from a matrx product state represented by a list of state site tensors...">computeStateVector</a>(*<span class="keyword">this</span>);
<a name="l00204"></a>00204     }
<a name="l00205"></a>00205 
<a name="l00207"></a>00207 
<a name="l00213"></a><a class="code" href="structNutcracker_1_1State.html#a2664d25a239355d4fbdf92cdb846d255">00213</a>     complex&lt;double&gt; <a class="code" href="structNutcracker_1_1State.html#a2664d25a239355d4fbdf92cdb846d255" title="Computes the value of a single component of this state given the list of observed qudit values...">computeVectorComponent</a>(vector&lt;unsigned int&gt; <span class="keyword">const</span>&amp; observed_values) {
<a name="l00214"></a>00214         <span class="keywordflow">return</span> <a class="code" href="group__Flat.html#gab31a50af74ed4038f07ba0b1ed7a1719" title="Computes the value of a single component of a quantum state given the list of observed qudit values...">computeStateVectorComponent</a>(*<span class="keyword">this</span>,observed_values);
<a name="l00215"></a>00215     }
<a name="l00216"></a>00216 
<a name="l00218"></a>00218 
<a name="l00224"></a><a class="code" href="structNutcracker_1_1State.html#a022897a63e811e151b17cd7a9a82e251">00224</a>     complex&lt;double&gt; <a class="code" href="structNutcracker_1_1State.html#a022897a63e811e151b17cd7a9a82e251" title="Computes the value of a single component of this state given the index of the component in the flat r...">computeVectorComponent</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keyword">const</span> component) {
<a name="l00225"></a>00225         <span class="keywordflow">return</span> <a class="code" href="group__Flat.html#gab31a50af74ed4038f07ba0b1ed7a1719" title="Computes the value of a single component of a quantum state given the list of observed qudit values...">computeStateVectorComponent</a>(*<span class="keyword">this</span>,component);
<a name="l00226"></a>00226     }
<a name="l00227"></a>00227 
<a name="l00229"></a>00229 
<a name="l00232"></a><a class="code" href="structNutcracker_1_1State.html#a9d187a009299605919827331a6d7ee34">00232</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="structNutcracker_1_1State.html#a9d187a009299605919827331a6d7ee34" title="Computes the number of components of the flat vector representation of this state.">computeVectorLength</a>() {
<a name="l00233"></a>00233         <span class="keywordflow">return</span> <a class="code" href="group__Flat.html#ga16bd5b15f05f10d0132b03192c61b9ee" title="Computes the number of components in the flat vector representation of the state.">computeStateVectorLength</a>(*<span class="keyword">this</span>);
<a name="l00234"></a>00234     }
<a name="l00235"></a>00235 
<a name="l00237"></a>00237     <span class="comment">//@+node:gcross.20110430223656.2185: *4* Informational</span>
<a name="l00239"></a>00239 <span class="comment"></span>
<a name="l00241"></a>00241 
<a name="l00242"></a>00242     <span class="keyword">public</span>:
<a name="l00243"></a>00243 
<a name="l00245"></a><a class="code" href="structNutcracker_1_1State.html#a19a838dd46cce8df6dfd1e0515b8d18b">00245</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structNutcracker_1_1State.html#a19a838dd46cce8df6dfd1e0515b8d18b" title="Returns the number of sites in this matrix product state;.">numberOfSites</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1+<a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>.size(); }
<a name="l00246"></a>00246 
<a name="l00248"></a>00248     <span class="comment">//@+node:gcross.20110430223656.2186: *4* Iteration support</span>
<a name="l00253"></a>00253 <span class="comment"></span>
<a name="l00254"></a>00254 
<a name="l00255"></a>00255     <span class="keyword">public</span>:
<a name="l00256"></a>00256 
<a name="l00258"></a>00258 
<a name="l00261"></a><a class="code" href="classNutcracker_1_1State_1_1const__iterator.html">00261</a>     <span class="keyword">class </span><a class="code" href="classNutcracker_1_1State_1_1const__iterator.html" title="Support class used for iteration over the sites in State.">const_iterator</a> :
<a name="l00262"></a>00262         <span class="keyword">public</span> iterator_facade&lt;
<a name="l00263"></a>00263              const_iterator
<a name="l00264"></a>00264             ,StateSiteAny const
<a name="l00265"></a>00265             ,random_access_traversal_tag
<a name="l00266"></a>00266         &gt;
<a name="l00267"></a>00267     {
<a name="l00269"></a>00269         <a class="code" href="structNutcracker_1_1State.html" title="Matrix product state in canonical form.">State</a> <span class="keyword">const</span>* state;
<a name="l00271"></a>00271         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index;
<a name="l00272"></a>00272     <span class="keyword">public</span>:
<a name="l00274"></a><a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#abe2ecbec40ca616789842b6061c64ea9">00274</a>         <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#abe2ecbec40ca616789842b6061c64ea9" title="Construct a new iterator using the given state and index.">const_iterator</a>(
<a name="l00275"></a>00275               <a class="code" href="structNutcracker_1_1State.html" title="Matrix product state in canonical form.">State</a> <span class="keyword">const</span>* state
<a name="l00276"></a>00276             , <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> index
<a name="l00277"></a>00277         ) : state(state)
<a name="l00278"></a>00278           , index(index)
<a name="l00279"></a>00279         {}
<a name="l00280"></a>00280 
<a name="l00282"></a><a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#a55b65ab0ee4899e6357e2854623c9c5a">00282</a>         <a class="code" href="classNutcracker_1_1StateSiteAny.html">StateSiteAny</a> <span class="keyword">const</span>&amp; <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#a55b65ab0ee4899e6357e2854623c9c5a" title="Access the site at the current index.">dereference</a>()<span class="keyword"> const </span>{
<a name="l00283"></a>00283             <span class="keywordflow">return</span> (*state)[index];
<a name="l00284"></a>00284         }
<a name="l00285"></a>00285 
<a name="l00287"></a><a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#abc66fc29ccb4483bb2ebabd48b8b6c3b">00287</a>         <span class="keywordtype">bool</span> <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#abc66fc29ccb4483bb2ebabd48b8b6c3b" title="Chech whether two iterators are equal.">equal</a>(<a class="code" href="classNutcracker_1_1State_1_1const__iterator.html" title="Support class used for iteration over the sites in State.">const_iterator</a> <span class="keyword">const</span>&amp; other)<span class="keyword"> const </span>{
<a name="l00288"></a>00288             <span class="keywordflow">return</span> (state == other.state) &amp;&amp; (index == other.index);
<a name="l00289"></a>00289         }
<a name="l00290"></a>00290 
<a name="l00292"></a><a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#a24d6b5a698ab5359b777c85a777be3ff">00292</a>         <span class="keywordtype">void</span> <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#a24d6b5a698ab5359b777c85a777be3ff" title="Increment the iterator.">increment</a>() { ++index; }
<a name="l00294"></a><a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#a244e052b7e64cbb3cf31786b11fd0526">00294</a>         <span class="keywordtype">void</span> <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#a244e052b7e64cbb3cf31786b11fd0526" title="Decrement the iterator.">decrement</a>() { --index; }
<a name="l00295"></a>00295 
<a name="l00297"></a><a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#adb1f3f75d0b392e1c72563940a4a6965">00297</a>         <span class="keywordtype">void</span> <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#adb1f3f75d0b392e1c72563940a4a6965" title="Advance the iterator by n sites.">advance</a>(<span class="keywordtype">size_t</span> n) { index += n; }
<a name="l00298"></a>00298 
<a name="l00300"></a><a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#a1f26eb7a5b3cc77bb0da54f1e072edcd">00300</a>         <span class="keywordtype">size_t</span> <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html#a1f26eb7a5b3cc77bb0da54f1e072edcd" title="Compute the distance in indices between other and this.">distance_to</a>(<a class="code" href="classNutcracker_1_1State_1_1const__iterator.html" title="Support class used for iteration over the sites in State.">const_iterator</a> <span class="keyword">const</span>&amp; other)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> other.index - index; }
<a name="l00301"></a>00301     };
<a name="l00302"></a>00302 
<a name="l00303"></a>00303     <span class="keyword">typedef</span> const_iterator iterator;
<a name="l00304"></a>00304 
<a name="l00306"></a><a class="code" href="structNutcracker_1_1State.html#a92b930e798ccba5f3c3fb8d8faed691e">00306</a>     <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html" title="Support class used for iteration over the sites in State.">const_iterator</a> <a class="code" href="structNutcracker_1_1State.html#a92b930e798ccba5f3c3fb8d8faed691e" title="Returns an iterator at the first site in the matrix product state.">begin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html" title="Support class used for iteration over the sites in State.">const_iterator</a>(<span class="keyword">this</span>,0); }
<a name="l00307"></a>00307 
<a name="l00309"></a><a class="code" href="structNutcracker_1_1State.html#a5adceacc69a98883a46ebb3bf0d11a7d">00309</a>     <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html" title="Support class used for iteration over the sites in State.">const_iterator</a> <a class="code" href="structNutcracker_1_1State.html#a5adceacc69a98883a46ebb3bf0d11a7d" title="Returns an iterator just past the last site in the matrix product state.">end</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html" title="Support class used for iteration over the sites in State.">const_iterator</a>(<span class="keyword">this</span>,<a class="code" href="structNutcracker_1_1State.html#a19a838dd46cce8df6dfd1e0515b8d18b" title="Returns the number of sites in this matrix product state;.">numberOfSites</a>()); }
<a name="l00310"></a>00310 
<a name="l00312"></a>00312     <span class="comment">//@+node:gcross.20110430223656.2187: *4* Site access</span>
<a name="l00314"></a>00314 <span class="comment"></span>
<a name="l00316"></a>00316 
<a name="l00317"></a>00317     <span class="keyword">public</span>:
<a name="l00318"></a>00318 
<a name="l00320"></a><a class="code" href="structNutcracker_1_1State.html#a87cf4008a50464000020c5a547598bee">00320</a>     <a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Middle&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="structNutcracker_1_1State.html#a87cf4008a50464000020c5a547598bee" title="Returns the left-most site.">getFirstSite</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structNutcracker_1_1State.html#a3f84a6bf1065a114216f8ab49e5a17f3" title="The left-most site in the matrix product state.">first_site</a>; }
<a name="l00321"></a>00321 
<a name="l00323"></a><a class="code" href="structNutcracker_1_1State.html#af0d51fb41943a889b81762da20cb7e4a">00323</a>     vector&lt;StateSite&lt;Right&gt; &gt; <span class="keyword">const</span>&amp; <a class="code" href="structNutcracker_1_1State.html#af0d51fb41943a889b81762da20cb7e4a" title="Returns the vector of sites after the left-most site.">getRestSites</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>; }
<a name="l00324"></a>00324 
<a name="l00326"></a><a class="code" href="structNutcracker_1_1State.html#aaeeee3c5f60d669e01cbe32a1126ddbf">00326</a>     <a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Right&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="structNutcracker_1_1State.html#aaeeee3c5f60d669e01cbe32a1126ddbf" title="Returns the site at index i after the left-most site.">getRestSite</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>[i]; }
<a name="l00327"></a>00327 
<a name="l00329"></a>00329 
<a name="l00332"></a><a class="code" href="structNutcracker_1_1State.html#a0cc0c2e610c8802a062a9d2730810225">00332</a>     <a class="code" href="classNutcracker_1_1StateSiteAny.html">StateSiteAny</a> <span class="keyword">const</span>&amp; <a class="code" href="structNutcracker_1_1State.html#a0cc0c2e610c8802a062a9d2730810225" title="Returns the site at index i.">operator[]</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i)<span class="keyword"> const </span>{
<a name="l00333"></a>00333         <span class="keywordflow">if</span>(i == 0) <span class="keywordflow">return</span> <a class="code" href="structNutcracker_1_1State.html#a3f84a6bf1065a114216f8ab49e5a17f3" title="The left-most site in the matrix product state.">first_site</a>;
<a name="l00334"></a>00334         <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="structNutcracker_1_1State.html#ac2f7cb93832f2d87a6c82d8b91862111" title="Vector of sites excluding the left-most site in the matrix product state.">rest_sites</a>[i-1];
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336 
<a name="l00338"></a>00338     <span class="comment">//@-others</span>
<a name="l00339"></a>00339 };
<a name="l00340"></a>00340 <span class="comment">//@+node:gcross.20110213161858.1813: ** Functions</span>
<a name="l00341"></a>00341 IncreaseDimensionBetweenResult&lt;Right,Right&gt; increaseDimensionBetweenRightRight(
<a name="l00342"></a>00342       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> new_dimension
<a name="l00343"></a>00343     , StateSite&lt;Right&gt; <span class="keyword">const</span>&amp; old_site_1
<a name="l00344"></a>00344     , StateSite&lt;Right&gt; <span class="keyword">const</span>&amp; old_site_2
<a name="l00345"></a>00345 );
<a name="l00346"></a>00346 
<a name="l00347"></a>00347 IncreaseDimensionBetweenResult&lt;Middle,Right&gt; increaseDimensionBetweenMiddleRight(
<a name="l00348"></a>00348       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> new_dimension
<a name="l00349"></a>00349     , StateSite&lt;Middle&gt; <span class="keyword">const</span>&amp; old_site_1
<a name="l00350"></a>00350     , StateSite&lt;Right&gt; <span class="keyword">const</span>&amp; old_site_2
<a name="l00351"></a>00351 );
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 MoveSiteCursorResult&lt;Left&gt; moveSiteCursorLeft(
<a name="l00354"></a>00354       StateSite&lt;Middle&gt; <span class="keyword">const</span>&amp; old_state_site_2
<a name="l00355"></a>00355     , StateSite&lt;Left&gt; <span class="keyword">const</span>&amp; old_state_site_1
<a name="l00356"></a>00356 );
<a name="l00357"></a>00357 
<a name="l00358"></a>00358 MoveSiteCursorResult&lt;Right&gt; moveSiteCursorRight(
<a name="l00359"></a>00359       StateSite&lt;Middle&gt; <span class="keyword">const</span>&amp; old_state_site_1
<a name="l00360"></a>00360     , StateSite&lt;Right&gt; <span class="keyword">const</span>&amp; old_state_site_2
<a name="l00361"></a>00361 );
<a name="l00362"></a>00362 
<a name="l00363"></a>00363 StateSite&lt;Middle&gt; randomStateSiteMiddle(
<a name="l00364"></a>00364       <span class="keyword">const</span> PhysicalDimension physical_dimension
<a name="l00365"></a>00365     , <span class="keyword">const</span> LeftDimension left_dimension
<a name="l00366"></a>00366     , <span class="keyword">const</span> RightDimension right_dimension
<a name="l00367"></a>00367 );
<a name="l00368"></a>00368 
<a name="l00369"></a>00369 StateSite&lt;Right&gt; randomStateSiteRight(
<a name="l00370"></a>00370       <span class="keyword">const</span> PhysicalDimension physical_dimension
<a name="l00371"></a>00371     , <span class="keyword">const</span> LeftDimension left_dimension
<a name="l00372"></a>00372     , <span class="keyword">const</span> RightDimension right_dimension
<a name="l00373"></a>00373 );
<a name="l00374"></a>00374 <span class="comment">//@+node:gcross.20110215235924.1909: *3* computeExpectationValue</span>
<a name="l00375"></a>00375 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> StateSiteRange&gt; complex&lt;double&gt; computeExpectationValue(
<a name="l00376"></a>00376       StateSiteRange <span class="keyword">const</span>&amp; state_sites
<a name="l00377"></a>00377     , Operator <span class="keyword">const</span>&amp; operator_sites
<a name="l00378"></a>00378 ) {
<a name="l00379"></a>00379     BOOST_CONCEPT_ASSERT((SinglePassRangeConcept&lt;StateSiteRange const&gt;));
<a name="l00380"></a>00380     ExpectationBoundary&lt;Left&gt; left_boundary(<a class="code" href="group__DummyArguments.html#gab348bc87d12559fc5e924286d3e6d6fd" title="The singleton instance of MakeTrivial.">make_trivial</a>);
<a name="l00381"></a>00381     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;
<a name="l00382"></a>00382     BOOST_FOREACH(StateSiteAny <span class="keyword">const</span>&amp; state_site, state_sites) {
<a name="l00383"></a>00383         left_boundary =
<a name="l00384"></a>00384             <a class="code" href="group__BoundaryContractors.html#ga4bfe054b8a7fdbb5cd136b6cfd60aedb" title="Contracts the state and operator site tensors into the left boundary.">Unsafe::contractSOSLeft</a>(
<a name="l00385"></a>00385                  left_boundary
<a name="l00386"></a>00386                 ,state_site
<a name="l00387"></a>00387                 ,*operator_sites[i++]
<a name="l00388"></a>00388             );
<a name="l00389"></a>00389     }
<a name="l00390"></a>00390     assert(i == operator_sites.size() &amp;&amp; <span class="stringliteral">&quot;the number of state sites is greater than the number of operator sites&quot;</span>);
<a name="l00391"></a>00391     assert(left_boundary.size() == 1);
<a name="l00392"></a>00392     <span class="keywordflow">return</span> left_boundary[0];
<a name="l00393"></a>00393 }
<a name="l00394"></a>00394 <span class="comment">//@+node:gcross.20110215235924.2015: *3* Unsafe</span>
<a name="l00395"></a>00395 <span class="keyword">namespace </span>Unsafe {
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="comment">//@+others</span>
<a name="l00398"></a>00398 <span class="comment">//@+node:gcross.20110215235924.2016: *4* increaseDimensionBetween</span>
<a name="l00399"></a>00399 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> s<span class="keywordtype">id</span>e1,<span class="keyword">typename</span> s<span class="keywordtype">id</span>e2&gt;
<a name="l00400"></a>00400 IncreaseDimensionBetweenResult&lt;side1,side2&gt; increaseDimensionBetween(
<a name="l00401"></a>00401       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> new_dimension
<a name="l00402"></a>00402     , StateSiteAny <span class="keyword">const</span>&amp; old_site_1
<a name="l00403"></a>00403     , StateSiteAny <span class="keyword">const</span>&amp; old_site_2
<a name="l00404"></a>00404 ) {
<a name="l00405"></a>00405     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> old_dimension = connectDimensions(
<a name="l00406"></a>00406          <span class="stringliteral">&quot;state site 1 right&quot;</span>
<a name="l00407"></a>00407         ,old_site_1.rightDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00408"></a>00408         ,<span class="stringliteral">&quot;state site 2 left&quot;</span>
<a name="l00409"></a>00409         ,old_site_2.leftDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00410"></a>00410     );
<a name="l00411"></a>00411     assert(new_dimension &gt;= old_dimension);
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     StateSite&lt;side1&gt; new_site_1(
<a name="l00414"></a>00414          old_site_1.physicalDimension()
<a name="l00415"></a>00415         ,old_site_1.leftDimension()
<a name="l00416"></a>00416         ,RightDimension(new_dimension)
<a name="l00417"></a>00417     );
<a name="l00418"></a>00418     StateSite&lt;side2&gt; new_site_2(
<a name="l00419"></a>00419          old_site_2.physicalDimension()
<a name="l00420"></a>00420         ,LeftDimension(new_dimension)
<a name="l00421"></a>00421         ,old_site_2.rightDimension()
<a name="l00422"></a>00422     );
<a name="l00423"></a>00423 
<a name="l00424"></a>00424     <span class="keywordtype">int</span> <span class="keyword">const</span> info =
<a name="l00425"></a>00425         new_dimension &gt; old_dimension
<a name="l00426"></a>00426             ? Core::increase_bandwidth_between(
<a name="l00427"></a>00427                  old_site_1.leftDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00428"></a>00428                 ,old_dimension
<a name="l00429"></a>00429                 ,old_site_2.rightDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00430"></a>00430                 ,old_site_1.physicalDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00431"></a>00431                 ,old_site_2.physicalDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00432"></a>00432                 ,new_dimension
<a name="l00433"></a>00433                 ,old_site_1
<a name="l00434"></a>00434                 ,old_site_2
<a name="l00435"></a>00435                 ,new_site_1
<a name="l00436"></a>00436                 ,new_site_2
<a name="l00437"></a>00437               )
<a name="l00438"></a>00438             : Core::norm_denorm_going_left(
<a name="l00439"></a>00439                  old_site_1.leftDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00440"></a>00440                 ,old_dimension
<a name="l00441"></a>00441                 ,old_site_2.rightDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00442"></a>00442                 ,old_site_1.physicalDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00443"></a>00443                 ,old_site_2.physicalDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00444"></a>00444                 ,old_site_1
<a name="l00445"></a>00445                 ,old_site_2
<a name="l00446"></a>00446                 ,new_site_1
<a name="l00447"></a>00447                 ,new_site_2
<a name="l00448"></a>00448               )
<a name="l00449"></a>00449     ;
<a name="l00450"></a>00450     <span class="keywordflow">if</span>(info != 0) <span class="keywordflow">throw</span> NormalizationError(info);
<a name="l00451"></a>00451     <span class="keywordflow">return</span> IncreaseDimensionBetweenResult&lt;side1,side2&gt;
<a name="l00452"></a>00452         (boost::move(new_site_1)
<a name="l00453"></a>00453         ,boost::move(new_site_2)
<a name="l00454"></a>00454         );
<a name="l00455"></a>00455 }
<a name="l00456"></a>00456 <span class="comment">//@-others</span>
<a name="l00457"></a>00457 
<a name="l00458"></a>00458 }
<a name="l00459"></a>00459 <span class="comment">//@+node:gcross.20110213233103.2755: ** struct moveSiteCursor</span>
<a name="l00460"></a><a class="code" href="structNutcracker_1_1moveSiteCursor.html">00460</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> s<span class="keywordtype">id</span>e&gt; <span class="keyword">struct </span><a class="code" href="structNutcracker_1_1moveSiteCursor.html">moveSiteCursor</a> { };
<a name="l00461"></a>00461 
<a name="l00462"></a><a class="code" href="structNutcracker_1_1moveSiteCursor_3_01Left_01_4.html">00462</a> <span class="keyword">template</span>&lt;&gt; <span class="keyword">struct </span><a class="code" href="structNutcracker_1_1moveSiteCursor.html">moveSiteCursor</a>&lt;Left&gt; {
<a name="l00463"></a>00463     <span class="keyword">static</span> <a class="code" href="classNutcracker_1_1MoveSiteCursorResult.html">MoveSiteCursorResult&lt;Left&gt;</a> from(
<a name="l00464"></a>00464           <a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Middle&gt;</a> <span class="keyword">const</span>&amp; old_middle_state_site
<a name="l00465"></a>00465        , <a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Left&gt;</a> <span class="keyword">const</span>&amp; old_left_state_site
<a name="l00466"></a>00466     ) { <span class="keywordflow">return</span> moveSiteCursorLeft(old_middle_state_site,old_left_state_site); }
<a name="l00467"></a>00467 };
<a name="l00468"></a>00468 
<a name="l00469"></a><a class="code" href="structNutcracker_1_1moveSiteCursor_3_01Right_01_4.html">00469</a> <span class="keyword">template</span>&lt;&gt; <span class="keyword">struct </span><a class="code" href="structNutcracker_1_1moveSiteCursor.html">moveSiteCursor</a>&lt;Right&gt; {
<a name="l00470"></a>00470     <span class="keyword">static</span> <a class="code" href="classNutcracker_1_1MoveSiteCursorResult.html">MoveSiteCursorResult&lt;Right&gt;</a> from(
<a name="l00471"></a>00471           <a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Middle&gt;</a> <span class="keyword">const</span>&amp; old_middle_state_site
<a name="l00472"></a>00472        , <a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Right&gt;</a> <span class="keyword">const</span>&amp; old_right_state_site
<a name="l00473"></a>00473     ) { <span class="keywordflow">return</span> moveSiteCursorRight(old_middle_state_site,old_right_state_site); }
<a name="l00474"></a>00474 };
<a name="l00475"></a>00475 <span class="comment">//@-others</span>
<a name="l00476"></a>00476 
<a name="l00477"></a>00477 }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479 <span class="comment">//@+&lt;&lt; Outside namespace &gt;&gt;</span>
<a name="l00480"></a>00480 <span class="comment">//@+node:gcross.20110430223656.2189: ** &lt;&lt; Outside namespace &gt;&gt;</span>
<a name="l00481"></a>00481 <span class="keyword">namespace </span>boost {
<a name="l00482"></a><a class="code" href="structboost_1_1range__iterator_3_01Nutcracker_1_1State_01const_01_01_4.html">00482</a>     <span class="keyword">template</span>&lt;&gt; <span class="keyword">struct </span>range_iterator&lt;Nutcracker::State const&gt; { <span class="keyword">typedef</span> <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html" title="Support class used for iteration over the sites in State.">Nutcracker::State::const_iterator</a> <a class="code" href="classNutcracker_1_1State_1_1const__iterator.html" title="Support class used for iteration over the sites in State.">type</a>; };
<a name="l00483"></a>00483 }
<a name="l00484"></a>00484 <span class="comment">//@-&lt;&lt; Outside namespace &gt;&gt;</span>
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 <span class="preprocessor">#endif</span>
<a name="l00487"></a>00487 <span class="preprocessor"></span><span class="comment">//@-leo</span>
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue May 31 2011 16:30:04 for Nutcracker by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
