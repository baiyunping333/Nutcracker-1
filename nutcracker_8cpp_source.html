<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nutcracker: nutcracker.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script src="http://www.mathjax.org/mathjax/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nutcracker</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>nutcracker.cpp</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//@+leo-ver=5-thin</span>
<a name="l00002"></a>00002 <span class="comment">//@+node:gcross.20110220141808.2717: * @file nutcracker.cpp</span>
<a name="l00003"></a>00003 <span class="comment">//@@language cplusplus</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="comment">//@+&lt;&lt; License &gt;&gt;</span>
<a name="l00006"></a>00006 <span class="comment">//@+node:gcross.20110220182654.2044: ** &lt;&lt; License &gt;&gt;</span>
<a name="l00007"></a>00007 <span class="comment">//@+at</span>
<a name="l00008"></a>00008 <span class="comment">// Copyright (c) 2011, Gregory Crosswhite</span>
<a name="l00009"></a>00009 <span class="comment">// All rights reserved.</span>
<a name="l00010"></a>00010 <span class="comment">// </span>
<a name="l00011"></a>00011 <span class="comment">// Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00012"></a>00012 <span class="comment">// </span>
<a name="l00013"></a>00013 <span class="comment">//     * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00014"></a>00014 <span class="comment">//     * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00015"></a>00015 <span class="comment">// </span>
<a name="l00016"></a>00016 <span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00017"></a>00017 <span class="comment">//@@c</span>
<a name="l00018"></a>00018 <span class="comment">//@-&lt;&lt; License &gt;&gt;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="comment">//@+&lt;&lt; Includes &gt;&gt;</span>
<a name="l00021"></a>00021 <span class="comment">//@+node:gcross.20110220141808.2718: ** &lt;&lt; Includes &gt;&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;boost/bind.hpp&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;boost/local/function.hpp&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;boost/format.hpp&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;boost/none.hpp&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;boost/none_t.hpp&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;boost/optional.hpp&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;boost/program_options.hpp&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;numeric&gt;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;chain.hpp&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;configuration.hpp&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;io.hpp&quot;</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="keyword">namespace </span>opts = boost::program_options;
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="keyword">using</span> boost::bind;
<a name="l00041"></a>00041 <span class="keyword">using</span> boost::format;
<a name="l00042"></a>00042 <span class="keyword">using</span> boost::lexical_cast;
<a name="l00043"></a>00043 <span class="keyword">using</span> boost::none;
<a name="l00044"></a>00044 <span class="keyword">using</span> boost::none_t;
<a name="l00045"></a>00045 <span class="keyword">using</span> boost::optional;
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="keyword">using</span> std::auto_ptr;
<a name="l00048"></a>00048 <span class="keyword">using</span> std::cerr;
<a name="l00049"></a>00049 <span class="keyword">using</span> std::endl;
<a name="l00050"></a>00050 <span class="keyword">using</span> std::ifstream;
<a name="l00051"></a>00051 <span class="keyword">using</span> std::string;
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="keyword">using</span> <a class="code" href="classNutcracker_1_1Chain.html">Nutcracker::Chain</a>;
<a name="l00054"></a>00054 <span class="keyword">using</span> <a class="code" href="structNutcracker_1_1Destructable.html">Nutcracker::Destructable</a>;
<a name="l00055"></a>00055 <span class="keyword">using</span> <a class="code" href="structNutcracker_1_1FormatDoesNotSupportLocationsError.html">Nutcracker::FormatDoesNotSupportLocationsError</a>;
<a name="l00056"></a>00056 <span class="keyword">using</span> <a class="code" href="structNutcracker_1_1FormatDoesNotSupportPipeError.html">Nutcracker::FormatDoesNotSupportPipeError</a>;
<a name="l00057"></a>00057 <span class="keyword">using</span> <a class="code" href="structNutcracker_1_1InputFormat.html">Nutcracker::InputFormat</a>;
<a name="l00058"></a>00058 <span class="keyword">using</span> <a class="code" href="classNutcracker_1_1InputOptions.html">Nutcracker::InputOptions</a>;
<a name="l00059"></a>00059 <span class="keyword">using</span> <a class="code" href="structNutcracker_1_1NoFormatTypeSpecifiedError.html">Nutcracker::NoFormatTypeSpecifiedError</a>;
<a name="l00060"></a>00060 <span class="keyword">using</span> <a class="code" href="structNutcracker_1_1NoSuchFormatError.html">Nutcracker::NoSuchFormatError</a>;
<a name="l00061"></a>00061 <span class="keyword">using</span> Nutcracker::Operator;
<a name="l00062"></a>00062 <span class="keyword">using</span> <a class="code" href="classNutcracker_1_1Options.html">Nutcracker::Options</a>;
<a name="l00063"></a>00063 <span class="keyword">using</span> <a class="code" href="classNutcracker_1_1OptimizerMode.html">Nutcracker::OptimizerMode</a>;
<a name="l00064"></a>00064 <span class="keyword">using</span> <a class="code" href="structNutcracker_1_1OutputFormat.html">Nutcracker::OutputFormat</a>;
<a name="l00065"></a>00065 <span class="keyword">using</span> <a class="code" href="structNutcracker_1_1OutputFormatDoesNotSupportStatesError.html">Nutcracker::OutputFormatDoesNotSupportStatesError</a>;
<a name="l00066"></a>00066 <span class="keyword">using</span> <a class="code" href="classNutcracker_1_1OutputOptions.html">Nutcracker::OutputOptions</a>;
<a name="l00067"></a>00067 <span class="keyword">using</span> <a class="code" href="classNutcracker_1_1ToleranceOptions.html">Nutcracker::ToleranceOptions</a>;
<a name="l00068"></a>00068 <span class="keyword">using</span> Nutcracker::vector;
<a name="l00069"></a>00069 <span class="comment">//@-&lt;&lt; Includes &gt;&gt;</span>
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="comment">//@+others</span>
<a name="l00072"></a>00072 <span class="comment">//@+node:gcross.20110511190907.3754: ** Classes</span>
<a name="l00073"></a>00073 <span class="comment">//@+node:gcross.20110511190907.3766: *3* HelpOptions</span>
<a name="l00074"></a><a class="code" href="classHelpOptions.html">00074</a> <span class="keyword">class </span><a class="code" href="classHelpOptions.html">HelpOptions</a> : <span class="keyword">public</span> <a class="code" href="classNutcracker_1_1Options.html">Options</a> {
<a name="l00075"></a>00075     <span class="comment">//@+others</span>
<a name="l00076"></a>00076     <span class="comment">//@+node:gcross.20110511190907.3767: *4* Constructors</span>
<a name="l00077"></a>00077     <span class="keyword">public</span>:
<a name="l00078"></a>00078 
<a name="l00079"></a>00079     <a class="code" href="classHelpOptions.html">HelpOptions</a>(opts::options_description <span class="keyword">const</span>&amp; all_options)
<a name="l00080"></a>00080       : <a class="code" href="classNutcracker_1_1Options.html">Options</a>(<span class="stringliteral">&quot;Help options&quot;</span>)
<a name="l00081"></a>00081       , all_options(all_options)
<a name="l00082"></a>00082     {
<a name="l00083"></a>00083         options.add_options()
<a name="l00084"></a>00084             (<span class="stringliteral">&quot;help&quot;</span>, opts::bool_switch()-&gt;notifier(bind(&amp;HelpOptions::runPrintHelpMessageAndExit,<span class="keyword">this</span>,_1))-&gt;zero_tokens(),
<a name="l00085"></a>00085                 <span class="stringliteral">&quot;print help message and exit\n&quot;</span>)
<a name="l00086"></a>00086             (<span class="stringliteral">&quot;help-formats&quot;</span>, opts::bool_switch()-&gt;notifier(bind(&amp;HelpOptions::runPrintHelpFormatsMessageAndExit,<span class="keyword">this</span>,_1))-&gt;zero_tokens(),
<a name="l00087"></a>00087                 <span class="stringliteral">&quot;print the supported input and output formats and exit\n&quot;</span>)
<a name="l00088"></a>00088             (<span class="stringliteral">&quot;help-modes&quot;</span>, opts::bool_switch()-&gt;notifier(bind(&amp;HelpOptions::runPrintHelpModesMessageAndExit,<span class="keyword">this</span>,_1))-&gt;zero_tokens(),
<a name="l00089"></a>00089                 <span class="stringliteral">&quot;print the supported optimizer modes\n&quot;</span>)
<a name="l00090"></a>00090         ;
<a name="l00091"></a>00091     }
<a name="l00092"></a>00092     <span class="comment">//@+node:gcross.20110511190907.3768: *4* Messages</span>
<a name="l00093"></a>00093     <span class="keyword">protected</span>:
<a name="l00094"></a>00094 
<a name="l00095"></a>00095     opts::options_description <span class="keyword">const</span>&amp; all_options;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097     <span class="keywordtype">void</span> runPrintHelpMessageAndExit(<span class="keywordtype">bool</span> <span class="keyword">const</span>&amp; run) { <span class="keywordflow">if</span>(run) printHelpMessageAndExit(); }
<a name="l00098"></a>00098     <span class="keywordtype">void</span> runPrintHelpFormatsMessageAndExit(<span class="keywordtype">bool</span> <span class="keyword">const</span>&amp; run) { <span class="keywordflow">if</span>(run) printHelpFormatsMessageAndExit(); }
<a name="l00099"></a>00099     <span class="keywordtype">void</span> runPrintHelpModesMessageAndExit(<span class="keywordtype">bool</span> <span class="keyword">const</span>&amp; run) { <span class="keywordflow">if</span>(run) printHelpModesMessageAndExit(); }
<a name="l00100"></a>00100 
<a name="l00101"></a>00101     <span class="keyword">public</span>:
<a name="l00102"></a>00102 
<a name="l00103"></a>00103     <span class="keywordtype">void</span> printHelpMessageAndExit() {
<a name="l00104"></a>00104         cerr
<a name="l00105"></a>00105             &lt;&lt; all_options
<a name="l00106"></a>00106             &lt;&lt; endl
<a name="l00107"></a>00107             &lt;&lt; <span class="stringliteral">&quot;Options may also be specified in &#39;nutcracker.cfg&#39; (or in an alternative configuration file specified via --config-file) in the format option=value.  For example, the line&quot;</span> &lt;&lt; endl
<a name="l00108"></a>00108             &lt;&lt; endl
<a name="l00109"></a>00109             &lt;&lt; <span class="stringliteral">&quot;\tsite-tolerance = 1e-10&quot;</span> &lt;&lt; endl
<a name="l00110"></a>00110             &lt;&lt; endl
<a name="l00111"></a>00111             &lt;&lt; <span class="stringliteral">&quot;is equivalence to specifying --site-tolerance 1e-10 on the command line.&quot;</span> &lt;&lt; endl
<a name="l00112"></a>00112         ;
<a name="l00113"></a>00113         exit(1);
<a name="l00114"></a>00114     }
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     <span class="keywordtype">void</span> printHelpFormatsMessageAndExit() {
<a name="l00117"></a>00117         cerr &lt;&lt; <span class="stringliteral">&quot;The recognized input format types are:&quot;</span> &lt;&lt; endl;
<a name="l00118"></a>00118         vector&lt;string&gt; names(InputFormat::listNames());
<a name="l00119"></a>00119         BOOST_FOREACH(<span class="keywordtype">string</span> <span class="keyword">const</span>&amp; name, names) {
<a name="l00120"></a>00120             cerr &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; InputFormat::lookupName(name).description &lt;&lt; endl;
<a name="l00121"></a>00121         }
<a name="l00122"></a>00122         cerr &lt;&lt; endl;
<a name="l00123"></a>00123         cerr &lt;&lt; <span class="stringliteral">&quot;The recognized output format types are:&quot;</span> &lt;&lt; endl;
<a name="l00124"></a>00124         names = OutputFormat::listNames();
<a name="l00125"></a>00125         BOOST_FOREACH(<span class="keywordtype">string</span> <span class="keyword">const</span>&amp; name, names) {
<a name="l00126"></a>00126             cerr &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; OutputFormat::lookupName(name).description &lt;&lt; endl;
<a name="l00127"></a>00127         }
<a name="l00128"></a>00128         cerr &lt;&lt; endl;
<a name="l00129"></a>00129         exit(1);
<a name="l00130"></a>00130     }
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <span class="keywordtype">void</span> printHelpModesMessageAndExit() {
<a name="l00133"></a>00133         cerr &lt;&lt; <span class="stringliteral">&quot;The recognized optimizer modes are:&quot;</span> &lt;&lt; endl;
<a name="l00134"></a>00134         vector&lt;string&gt; names(OptimizerMode::listNames());
<a name="l00135"></a>00135         BOOST_FOREACH(<span class="keywordtype">string</span> <span class="keyword">const</span>&amp; name, names) {
<a name="l00136"></a>00136             cerr &lt;&lt; <span class="stringliteral">&quot;  &#39;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;&#39; - &quot;</span> &lt;&lt; OptimizerMode::lookupName(name).getDescription() &lt;&lt; endl;
<a name="l00137"></a>00137         }
<a name="l00138"></a>00138         cerr &lt;&lt; endl;
<a name="l00139"></a>00139         exit(1);
<a name="l00140"></a>00140     }
<a name="l00141"></a>00141     <span class="comment">//@-others</span>
<a name="l00142"></a>00142 };
<a name="l00143"></a>00143 <span class="comment">//@+node:gcross.20110511190907.3760: *3* SimulationOptions</span>
<a name="l00144"></a><a class="code" href="classSimulationOptions.html">00144</a> <span class="keyword">class </span><a class="code" href="classSimulationOptions.html">SimulationOptions</a> : <span class="keyword">public</span> <a class="code" href="classNutcracker_1_1Options.html">Options</a> {
<a name="l00145"></a>00145     <span class="comment">//@+others</span>
<a name="l00146"></a>00146     <span class="comment">//@+node:gcross.20110511190907.3762: *4* Constructors</span>
<a name="l00147"></a>00147     <span class="keyword">public</span>:
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     <a class="code" href="classSimulationOptions.html">SimulationOptions</a>()
<a name="l00150"></a>00150       : <a class="code" href="classNutcracker_1_1Options.html">Options</a>(<span class="stringliteral">&quot;Simulation options&quot;</span>)
<a name="l00151"></a>00151     {
<a name="l00152"></a>00152         options.add_options()
<a name="l00153"></a>00153             (<span class="stringliteral">&quot;config-file,C&quot;</span>,
<a name="l00154"></a>00154                 <span class="stringliteral">&quot;configuration file\n&quot;</span>
<a name="l00155"></a>00155                 <span class="stringliteral">&quot;------------------\n&quot;</span>
<a name="l00156"></a>00156                 <span class="stringliteral">&quot;If this option is specified then Nutcracker will read option values from it instead of from &#39;nutcracker.cfg&#39;.\n&quot;</span>
<a name="l00157"></a>00157             )
<a name="l00158"></a>00158             (<span class="stringliteral">&quot;number-of-levels,n&quot;</span>, opts::value&lt;unsigned int&gt;(&amp;number_of_levels)-&gt;default_value(1),
<a name="l00159"></a>00159                 <span class="stringliteral">&quot;number of levels\n&quot;</span>
<a name="l00160"></a>00160                 <span class="stringliteral">&quot;----------------\n&quot;</span>
<a name="l00161"></a>00161                 <span class="stringliteral">&quot;This value specifies the number of energy levels that Nutcracker should find (including the ground state).\n&quot;</span>
<a name="l00162"></a>00162                 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00163"></a>00163                 <span class="stringliteral">&quot;If this options is not specified then it defaults to 1 (i.e., ground state only).\n&quot;</span>
<a name="l00164"></a>00164             )
<a name="l00165"></a>00165             (<span class="stringliteral">&quot;optimizer-mode&quot;</span>, opts::value&lt;OptimizerMode&gt;(&amp;optimizer_mode)-&gt;default_value(OptimizerMode::least_value),
<a name="l00166"></a>00166                 <span class="stringliteral">&quot;optimizer-mode&quot;</span>
<a name="l00167"></a>00167                 <span class="stringliteral">&quot;--------------\n&quot;</span>
<a name="l00168"></a>00168                 <span class="stringliteral">&quot;This value specifies the mode of the optimizer;  this is the option you want to specify if you don&#39;t just want to find the solutions with the least eigenvalues.  Run Nutcracker with --help-modes to list the available modes.\n&quot;</span>
<a name="l00169"></a>00169                 <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00170"></a>00170                 <span class="stringliteral">&quot;If this options is not specified then it defaults to &#39;&lt;v&#39; (least value).\n&quot;</span>
<a name="l00171"></a>00171             )
<a name="l00172"></a>00172         ;
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174     <span class="comment">//@+node:gcross.20110511190907.3761: *4* Fields</span>
<a name="l00175"></a>00175     <span class="keyword">protected</span>:
<a name="l00176"></a>00176 
<a name="l00177"></a>00177     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> number_of_levels;
<a name="l00178"></a>00178     <a class="code" href="classNutcracker_1_1OptimizerMode.html">OptimizerMode</a> optimizer_mode;
<a name="l00179"></a>00179 
<a name="l00180"></a>00180     <span class="keyword">public</span>:
<a name="l00181"></a>00181 
<a name="l00182"></a>00182     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> getSimulationNumberOfLevels()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> number_of_levels; }
<a name="l00183"></a>00183     <a class="code" href="classNutcracker_1_1OptimizerMode.html">OptimizerMode</a> <span class="keyword">const</span>&amp; getOptimizerMode()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> optimizer_mode; }
<a name="l00184"></a>00184     <span class="comment">//@-others</span>
<a name="l00185"></a>00185 };
<a name="l00186"></a>00186 <span class="comment">//@+node:gcross.20110511190907.3776: *3* ProgramOptions</span>
<a name="l00187"></a><a class="code" href="classProgramOptions.html">00187</a> <span class="keyword">class </span><a class="code" href="classProgramOptions.html">ProgramOptions</a>
<a name="l00188"></a>00188   : <span class="keyword">public</span> <a class="code" href="classHelpOptions.html">HelpOptions</a>
<a name="l00189"></a>00189   , <span class="keyword">public</span> <a class="code" href="classNutcracker_1_1InputOptions.html">InputOptions</a>
<a name="l00190"></a>00190   , <span class="keyword">public</span> <a class="code" href="classNutcracker_1_1OutputOptions.html">OutputOptions</a>
<a name="l00191"></a>00191   , <span class="keyword">public</span> <a class="code" href="classSimulationOptions.html">SimulationOptions</a>
<a name="l00192"></a>00192   , <span class="keyword">public</span> <a class="code" href="classNutcracker_1_1ToleranceOptions.html">ToleranceOptions</a>
<a name="l00193"></a>00193 {
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     opts::options_description options;
<a name="l00196"></a>00196 
<a name="l00197"></a>00197     <span class="keyword">public</span>:
<a name="l00198"></a>00198 
<a name="l00199"></a>00199     <a class="code" href="classProgramOptions.html">ProgramOptions</a>()
<a name="l00200"></a>00200         : <a class="code" href="classHelpOptions.html">HelpOptions</a>(options)
<a name="l00201"></a>00201         , options(<span class="stringliteral">&quot;All options&quot;</span>)
<a name="l00202"></a>00202     {
<a name="l00203"></a>00203         options.add(HelpOptions::options);
<a name="l00204"></a>00204         options.add(SimulationOptions::options);
<a name="l00205"></a>00205         options.add(InputOptions::options);
<a name="l00206"></a>00206         options.add(OutputOptions::options);
<a name="l00207"></a>00207         options.add(ToleranceOptions::options);
<a name="l00208"></a>00208     }
<a name="l00209"></a>00209 
<a name="l00210"></a>00210     operator opts::options_description&amp;() { <span class="keywordflow">return</span> options; }
<a name="l00211"></a>00211 };
<a name="l00212"></a>00212 <span class="comment">//@+node:gcross.20110220141808.2719: ** main</span>
<a name="l00213"></a>00213 <span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {
<a name="l00214"></a>00214     <a class="code" href="classProgramOptions.html">ProgramOptions</a> options;
<a name="l00215"></a>00215 
<a name="l00216"></a>00216     opts::variables_map vm;
<a name="l00217"></a>00217     <span class="keywordflow">try</span> {
<a name="l00218"></a>00218         opts::store(opts::parse_command_line(argc, argv, options), vm);
<a name="l00219"></a>00219         <span class="keywordtype">string</span> config_filename;
<a name="l00220"></a>00220         <span class="keywordflow">if</span>(vm.count(<span class="stringliteral">&quot;config-file&quot;</span>)) {
<a name="l00221"></a>00221             config_filename = vm[<span class="stringliteral">&quot;config-file&quot;</span>].as&lt;<span class="keywordtype">string</span>&gt;();
<a name="l00222"></a>00222         } <span class="keywordflow">else</span> {
<a name="l00223"></a>00223             config_filename = <span class="stringliteral">&quot;nutcracker.cfg&quot;</span>;
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225         ifstream config_file(config_filename.c_str());
<a name="l00226"></a>00226         opts::store(opts::parse_config_file(config_file, options), vm);
<a name="l00227"></a>00227         opts::notify(vm);
<a name="l00228"></a>00228     } <span class="keywordflow">catch</span>(std::exception <span class="keyword">const</span>&amp; e) {
<a name="l00229"></a>00229         cerr &lt;&lt; <span class="stringliteral">&quot;An error was encounted while parsing the options:&quot;</span> &lt;&lt; endl
<a name="l00230"></a>00230              &lt;&lt; endl
<a name="l00231"></a>00231              &lt;&lt; e.what() &lt;&lt; endl
<a name="l00232"></a>00232              &lt;&lt; endl
<a name="l00233"></a>00233              &lt;&lt; <span class="stringliteral">&quot;Run Nutcracker with the --help option for a description of the available options.&quot;</span> &lt;&lt; endl
<a name="l00234"></a>00234         ;
<a name="l00235"></a>00235         <span class="keywordflow">return</span> -1;
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237 
<a name="l00238"></a>00238     <span class="keywordflow">try</span> {
<a name="l00239"></a>00239 
<a name="l00240"></a>00240         <a class="code" href="structNutcracker_1_1InputFormat.html">InputFormat</a> <span class="keyword">const</span>&amp; input_format = options.resolveInputFormat();
<a name="l00241"></a>00241         <a class="code" href="structNutcracker_1_1OutputFormat.html">OutputFormat</a> <span class="keyword">const</span>&amp; output_format = options.resolveOutputFormat();
<a name="l00242"></a>00242 
<a name="l00243"></a>00243         Operator hamiltonian(options.readOperatorUsingInputFormat(input_format));
<a name="l00244"></a>00244 
<a name="l00245"></a>00245         <a class="code" href="classNutcracker_1_1Chain.html">Chain</a> chain
<a name="l00246"></a>00246             (hamiltonian
<a name="l00247"></a>00247             ,1
<a name="l00248"></a>00248             ,options.getToleranceChainOptions()
<a name="l00249"></a>00249             ,options.getOptimizerMode()
<a name="l00250"></a>00250             );
<a name="l00251"></a>00251 
<a name="l00252"></a>00252         auto_ptr&lt;Destructable const&gt; outputter = options.connectToChainUsingOutputFormat(output_format,chain);
<a name="l00253"></a>00253 
<a name="l00254"></a>00254         chain.solveForMultipleLevels(options.getSimulationNumberOfLevels());
<a name="l00255"></a>00255 
<a name="l00256"></a>00256     } <span class="keywordflow">catch</span> (<a class="code" href="structNutcracker_1_1NoSuchFormatError.html">NoSuchFormatError</a> <span class="keyword">const</span>&amp; e) {
<a name="l00257"></a>00257         cerr &lt;&lt; e.format_name &lt;&lt; <span class="stringliteral">&quot; is not a recognized/supported &quot;</span> &lt;&lt; e.format_type_name &lt;&lt; <span class="stringliteral">&quot; format type.&quot;</span> &lt;&lt; endl;
<a name="l00258"></a>00258         cerr &lt;&lt; endl;
<a name="l00259"></a>00259         cerr &lt;&lt; <span class="stringliteral">&quot;The recognized &quot;</span> &lt;&lt; e.format_type_name &lt;&lt; <span class="stringliteral">&quot; format types are:&quot;</span> &lt;&lt; endl;
<a name="l00260"></a>00260         vector&lt;string&gt; names(e.getAcceptedFormatNames());
<a name="l00261"></a>00261         BOOST_FOREACH(<span class="keywordtype">string</span> <span class="keyword">const</span>&amp; name, names) {
<a name="l00262"></a>00262             cerr &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; name &lt;&lt; endl;
<a name="l00263"></a>00263         }
<a name="l00264"></a>00264         cerr &lt;&lt; endl;
<a name="l00265"></a>00265         cerr &lt;&lt; <span class="stringliteral">&quot;Run Nutcracker with the --help-formats option for more informaton about supported formats.&quot;</span> &lt;&lt; endl;
<a name="l00266"></a>00266         <span class="keywordflow">return</span> -1;
<a name="l00267"></a>00267     } <span class="keywordflow">catch</span> (<a class="code" href="structNutcracker_1_1NoFormatTypeSpecifiedError.html">NoFormatTypeSpecifiedError</a> <span class="keyword">const</span>&amp; e) {
<a name="l00268"></a>00268         cerr &lt;&lt; <span class="stringliteral">&quot;No &quot;</span> &lt;&lt; e.format_type_name &lt;&lt; <span class="stringliteral">&quot; format type has been specified.&quot;</span> &lt;&lt; endl;
<a name="l00269"></a>00269         cerr &lt;&lt; endl;
<a name="l00270"></a>00270         cerr &lt;&lt; <span class="stringliteral">&quot;The recognized &quot;</span> &lt;&lt; e.format_type_name &lt;&lt; <span class="stringliteral">&quot; format types are:&quot;</span> &lt;&lt; endl;
<a name="l00271"></a>00271         vector&lt;string&gt; names(e.getAcceptedFormatNames());
<a name="l00272"></a>00272         BOOST_FOREACH(<span class="keywordtype">string</span> <span class="keyword">const</span>&amp; name, names) {
<a name="l00273"></a>00273             cerr &lt;&lt; <span class="stringliteral">&quot;  - &quot;</span> &lt;&lt; name &lt;&lt; endl;
<a name="l00274"></a>00274         }
<a name="l00275"></a>00275         cerr &lt;&lt; endl;
<a name="l00276"></a>00276         cerr &lt;&lt; <span class="stringliteral">&quot;Run Nutcracker with the --help-formats option for more informaton about supported formats.&quot;</span> &lt;&lt; endl;
<a name="l00277"></a>00277         <span class="keywordflow">return</span> -1;
<a name="l00278"></a>00278     } <span class="keywordflow">catch</span> (<a class="code" href="structNutcracker_1_1FormatDoesNotSupportPipeError.html">FormatDoesNotSupportPipeError</a> <span class="keyword">const</span>&amp; e) {
<a name="l00279"></a>00279         cerr &lt;&lt; <span class="stringliteral">&quot;The &quot;</span> &lt;&lt; e.format_type_name &lt;&lt; <span class="stringliteral">&quot; e.format type &quot;</span> &lt;&lt; e.format_name &lt;&lt; <span class="stringliteral">&quot; does not support piped &quot;</span> &lt;&lt; e.format_type_name &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; endl;
<a name="l00280"></a>00280         cerr &lt;&lt; <span class="stringliteral">&quot;You need to specify the &quot;</span> &lt;&lt; e.format_type_name &lt;&lt; <span class="stringliteral">&quot; in a file instead.&quot;</span> &lt;&lt; endl;
<a name="l00281"></a>00281         <span class="keywordflow">return</span> -1;
<a name="l00282"></a>00282     } <span class="keywordflow">catch</span> (<a class="code" href="structNutcracker_1_1FormatDoesNotSupportLocationsError.html">FormatDoesNotSupportLocationsError</a> <span class="keyword">const</span>&amp; e) {
<a name="l00283"></a>00283         cerr &lt;&lt; <span class="stringliteral">&quot;The &quot;</span> &lt;&lt; e.format_type_name &lt;&lt; <span class="stringliteral">&quot; format type &quot;</span> &lt;&lt; e.format_name &lt;&lt; <span class="stringliteral">&quot; does not support locations.&quot;</span> &lt;&lt; endl;
<a name="l00284"></a>00284         <span class="keywordflow">return</span> -1;
<a name="l00285"></a>00285     } <span class="keywordflow">catch</span> (<a class="code" href="structNutcracker_1_1OutputFormatDoesNotSupportStatesError.html">OutputFormatDoesNotSupportStatesError</a> <span class="keyword">const</span>&amp; e) {
<a name="l00286"></a>00286         cerr &lt;&lt; <span class="stringliteral">&quot;Output format &quot;</span> &lt;&lt; e.format_name &lt;&lt; <span class="stringliteral">&quot; does not support outputing states.&quot;</span> &lt;&lt; endl;
<a name="l00287"></a>00287         <span class="keywordflow">return</span> -1;
<a name="l00288"></a>00288     }
<a name="l00289"></a>00289 
<a name="l00290"></a>00290     <span class="keywordflow">return</span> 0;
<a name="l00291"></a>00291 }
<a name="l00292"></a>00292 <span class="comment">//@-others</span>
<a name="l00293"></a>00293 <span class="comment">//@-leo</span>
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue May 31 2011 16:30:04 for Nutcracker by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
