<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nutcracker: projectors.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script src="http://www.mathjax.org/mathjax/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nutcracker</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>projectors.hpp</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//@+leo-ver=5-thin</span>
<a name="l00002"></a>00002 <span class="comment">//@+node:gcross.20110213233103.2782: * @file projectors.hpp</span>
<a name="l00003"></a>00003 <span class="comment">//@@language cplusplus</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="comment">//@+&lt;&lt; License &gt;&gt;</span>
<a name="l00006"></a>00006 <span class="comment">//@+node:gcross.20110220182654.2016: ** &lt;&lt; License &gt;&gt;</span>
<a name="l00007"></a>00007 <span class="comment">//@+at</span>
<a name="l00008"></a>00008 <span class="comment">// Copyright (c) 2011, Gregory Crosswhite</span>
<a name="l00009"></a>00009 <span class="comment">// All rights reserved.</span>
<a name="l00010"></a>00010 <span class="comment">// </span>
<a name="l00011"></a>00011 <span class="comment">// Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00012"></a>00012 <span class="comment">// </span>
<a name="l00013"></a>00013 <span class="comment">//     * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00014"></a>00014 <span class="comment">//     * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00015"></a>00015 <span class="comment">// </span>
<a name="l00016"></a>00016 <span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00017"></a>00017 <span class="comment">//@@c</span>
<a name="l00018"></a>00018 <span class="comment">//@-&lt;&lt; License &gt;&gt;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#ifndef NUTCRACKER_PROJECTORS_HPP</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor">#define NUTCRACKER_PROJECTORS_HPP</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00023"></a>00023 <span class="comment">//@+&lt;&lt; Includes &gt;&gt;</span>
<a name="l00024"></a>00024 <span class="comment">//@+node:gcross.20110213233103.2783: ** &lt;&lt; Includes &gt;&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;boost/concept_check.hpp&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;boost/range/concepts.hpp&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;boost/tuple/tuple.hpp&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;utility&gt;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="boundaries_8hpp.html" title="Functions related to boundaries.">boundaries.hpp</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="core_8hpp.html" title="Core numeric kernels.">core.hpp</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;states.hpp&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;tensors.hpp&quot;</span>
<a name="l00034"></a>00034 <span class="comment">//@-&lt;&lt; Includes &gt;&gt;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="keyword">namespace </span>Nutcracker {
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="comment">//@+&lt;&lt; Usings &gt;&gt;</span>
<a name="l00039"></a>00039 <span class="comment">//@+node:gcross.20110213233103.2784: ** &lt;&lt; Usings &gt;&gt;</span>
<a name="l00040"></a>00040 <span class="keyword">using</span> boost::make_tuple;
<a name="l00041"></a>00041 <span class="keyword">using</span> boost::RandomAccessRangeConcept;
<a name="l00042"></a>00042 <span class="keyword">using</span> boost::SinglePassRangeConcept;
<a name="l00043"></a>00043 <span class="keyword">using</span> boost::tuple;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="keyword">using</span> std::make_pair;
<a name="l00046"></a>00046 <span class="comment">//@-&lt;&lt; Usings &gt;&gt;</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="comment">//@+others</span>
<a name="l00049"></a>00049 <span class="comment">//@+node:gcross.20110214164734.1919: ** Classes</span>
<a name="l00050"></a>00050 <span class="comment">//@+node:gcross.20110216193817.1917: *3* OverlapSitesFromStateSitesAndNormalizeResult</span>
<a name="l00051"></a><a class="code" href="classNutcracker_1_1OverlapSitesFromStateSitesAndNormalizeResult.html">00051</a> <span class="keyword">class </span><a class="code" href="classNutcracker_1_1OverlapSitesFromStateSitesAndNormalizeResult.html">OverlapSitesFromStateSitesAndNormalizeResult</a> {
<a name="l00052"></a>00052 <span class="keyword">private</span>:
<a name="l00053"></a>00053     BOOST_MOVABLE_BUT_NOT_COPYABLE(<a class="code" href="classNutcracker_1_1OverlapSitesFromStateSitesAndNormalizeResult.html">OverlapSitesFromStateSitesAndNormalizeResult</a>)
<a name="l00054"></a>00054 <span class="keyword">public</span>:
<a name="l00055"></a>00055     <a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;Left&gt;</a> left_overlap_site_from_middle_state_site;
<a name="l00056"></a>00056     <a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;Middle&gt;</a> middle_overlap_site_from_middle_state_site;
<a name="l00057"></a>00057     <a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Middle&gt;</a> middle_state_site_from_right_state_site;
<a name="l00058"></a>00058     <a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;Right&gt;</a> right_overlap_site_from_right_state_site;
<a name="l00059"></a>00059 
<a name="l00060"></a>00060     <a class="code" href="classNutcracker_1_1OverlapSitesFromStateSitesAndNormalizeResult.html">OverlapSitesFromStateSitesAndNormalizeResult</a>(
<a name="l00061"></a>00061           BOOST_RV_REF(<a class="code" href="classNutcracker_1_1OverlapSitesFromStateSitesAndNormalizeResult.html">OverlapSitesFromStateSitesAndNormalizeResult</a>) other
<a name="l00062"></a>00062     ) : left_overlap_site_from_middle_state_site(boost::move(other.left_overlap_site_from_middle_state_site))
<a name="l00063"></a>00063       , middle_overlap_site_from_middle_state_site(boost::move(other.middle_overlap_site_from_middle_state_site))
<a name="l00064"></a>00064       , middle_state_site_from_right_state_site(boost::move(other.middle_state_site_from_right_state_site))
<a name="l00065"></a>00065       , right_overlap_site_from_right_state_site(boost::move(other.right_overlap_site_from_right_state_site))
<a name="l00066"></a>00066     {}
<a name="l00067"></a>00067 
<a name="l00068"></a>00068     <a class="code" href="classNutcracker_1_1OverlapSitesFromStateSitesAndNormalizeResult.html">OverlapSitesFromStateSitesAndNormalizeResult</a>(
<a name="l00069"></a>00069           BOOST_RV_REF(<a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;Left&gt;</a>) left_overlap_site_from_middle_state_site
<a name="l00070"></a>00070         , BOOST_RV_REF(<a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;Middle&gt;</a>) middle_overlap_site_from_middle_state_site
<a name="l00071"></a>00071         , BOOST_RV_REF(<a class="code" href="classNutcracker_1_1StateSite.html">StateSite&lt;Middle&gt;</a>) middle_state_site_from_right_state_site
<a name="l00072"></a>00072         , BOOST_RV_REF(<a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;Right&gt;</a>) right_overlap_site_from_right_state_site
<a name="l00073"></a>00073     ) : left_overlap_site_from_middle_state_site(left_overlap_site_from_middle_state_site)
<a name="l00074"></a>00074       , middle_overlap_site_from_middle_state_site(middle_overlap_site_from_middle_state_site)
<a name="l00075"></a>00075       , middle_state_site_from_right_state_site(middle_state_site_from_right_state_site)
<a name="l00076"></a>00076       , right_overlap_site_from_right_state_site(right_overlap_site_from_right_state_site)
<a name="l00077"></a>00077     {}
<a name="l00078"></a>00078 };
<a name="l00079"></a>00079 <span class="comment">//@+node:gcross.20110220182654.2074: *3* Projector</span>
<a name="l00080"></a>00080 <span class="comment">//@+&lt;&lt; Description &gt;&gt;</span>
<a name="l00081"></a>00081 <span class="comment">//@+node:gcross.20110429225820.3839: *4* &lt;&lt; Description &gt;&gt;</span>
<a name="l00083"></a>00083 <span class="comment"></span>
<a name="l00086"></a>00086 <span class="comment">//@-&lt;&lt; Description &gt;&gt;</span>
<a name="l00087"></a>00087 <span class="keyword">class </span><a class="code" href="classNutcracker_1_1ProjectorSite.html" title="A projector site contains a left-, middle-, and right- normalized version of the same overlap site...">ProjectorSite</a>;
<a name="l00088"></a><a class="code" href="structNutcracker_1_1Projector.html">00088</a> <span class="keyword">struct </span><a class="code" href="structNutcracker_1_1Projector.html">Projector</a> : vector&lt;ProjectorSite&gt; {
<a name="l00089"></a>00089     <span class="comment">//@+others</span>
<a name="l00090"></a>00090     <span class="comment">//@+node:gcross.20110429225820.3841: *4* [Internal typedefs]</span>
<a name="l00091"></a>00091     <span class="keyword">private</span>:
<a name="l00092"></a>00092 
<a name="l00093"></a>00093     <span class="keyword">typedef</span> vector&lt;ProjectorSite&gt; Base;
<a name="l00094"></a>00094     <span class="comment">//@+node:gcross.20110429225820.3840: *4* [Move support]</span>
<a name="l00095"></a>00095     <span class="keyword">private</span>:
<a name="l00096"></a>00096 
<a name="l00097"></a>00097     BOOST_MOVABLE_BUT_NOT_COPYABLE(<a class="code" href="structNutcracker_1_1Projector.html">Projector</a>)
<a name="l00098"></a>00098     <span class="comment">//@+node:gcross.20110429225820.3842: *4* Assignment</span>
<a name="l00099"></a>00099     <span class="keyword">public</span>:
<a name="l00100"></a>00100 
<a name="l00102"></a><a class="code" href="structNutcracker_1_1Projector.html#aaf68e3372b371a984600d36a435ae7d4">00102</a>     <a class="code" href="structNutcracker_1_1Projector.html">Projector</a>&amp; <a class="code" href="structNutcracker_1_1Projector.html#aaf68e3372b371a984600d36a435ae7d4" title="Moves the contents of other into this. (other will be empty after this.)">operator=</a>(BOOST_RV_REF(<a class="code" href="structNutcracker_1_1Projector.html">Projector</a>) other) {
<a name="l00103"></a>00103         <span class="keywordflow">if</span>(<span class="keyword">this</span> == &amp;other) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00104"></a>00104         <a class="code" href="structNutcracker_1_1Projector.html#aaf68e3372b371a984600d36a435ae7d4" title="Moves the contents of other into this. (other will be empty after this.)">Base::operator=</a>(boost::move(static_cast&lt;Base&amp;&gt;(other)));
<a name="l00105"></a>00105         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00106"></a>00106     }
<a name="l00107"></a>00107 
<a name="l00109"></a><a class="code" href="structNutcracker_1_1Projector.html#af6894a8d0d088f9314c03d847c558485">00109</a>     <span class="keywordtype">void</span> <a class="code" href="structNutcracker_1_1Projector.html#af6894a8d0d088f9314c03d847c558485" title="Swaps the contents of other and this.">swap</a>(<a class="code" href="structNutcracker_1_1Projector.html">Projector</a>&amp; other) {
<a name="l00110"></a>00110         <a class="code" href="structNutcracker_1_1Projector.html#af6894a8d0d088f9314c03d847c558485" title="Swaps the contents of other and this.">Base::swap</a>(other);
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112     <span class="comment">//@+node:gcross.20110429225820.3838: *4* Constructors</span>
<a name="l00113"></a>00113     <span class="keyword">public</span>:
<a name="l00114"></a>00114 
<a name="l00116"></a><a class="code" href="structNutcracker_1_1Projector.html#aabe26aa6f2207e90cf1ab1eea820ef14">00116</a>     <a class="code" href="structNutcracker_1_1Projector.html#aabe26aa6f2207e90cf1ab1eea820ef14" title="Construct an empty projector.">Projector</a>() {}
<a name="l00117"></a>00117 
<a name="l00119"></a><a class="code" href="structNutcracker_1_1Projector.html#aab64ea27c82251ffd9e80c1cc8608380">00119</a>     <a class="code" href="structNutcracker_1_1Projector.html#aabe26aa6f2207e90cf1ab1eea820ef14" title="Construct an empty projector.">Projector</a>(BOOST_RV_REF(<a class="code" href="structNutcracker_1_1Projector.html">Projector</a>) other)
<a name="l00120"></a>00120       : Base(boost::move(static_cast&lt;Base&amp;&gt;(other)))
<a name="l00121"></a>00121     {}
<a name="l00122"></a>00122     <span class="comment">//@-others</span>
<a name="l00123"></a>00123 };
<a name="l00124"></a>00124 <span class="comment">//@+node:gcross.20110214164734.1921: *3* ProjectorMatrix</span>
<a name="l00125"></a><a class="code" href="classNutcracker_1_1ProjectorMatrix.html">00125</a> <span class="keyword">class </span><a class="code" href="classNutcracker_1_1ProjectorMatrix.html">ProjectorMatrix</a> {
<a name="l00126"></a>00126 <span class="keyword">private</span>:
<a name="l00127"></a>00127     BOOST_MOVABLE_BUT_NOT_COPYABLE(<a class="code" href="classNutcracker_1_1ProjectorMatrix.html">ProjectorMatrix</a>)
<a name="l00128"></a>00128     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>
<a name="l00129"></a>00129           number_of_projectors
<a name="l00130"></a>00130         , projector_length
<a name="l00131"></a>00131         , number_of_reflectors
<a name="l00132"></a>00132         , orthogonal_subspace_dimension
<a name="l00133"></a>00133         ;
<a name="l00134"></a>00134     complex&lt;double&gt; *reflector_data, *coefficient_data;
<a name="l00135"></a>00135     uint32_t* swap_data;
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="keyword">public</span>:
<a name="l00138"></a>00138     <a class="code" href="classNutcracker_1_1ProjectorMatrix.html">ProjectorMatrix</a>()
<a name="l00139"></a>00139       : number_of_projectors(0)
<a name="l00140"></a>00140       , projector_length(0)
<a name="l00141"></a>00141       , number_of_reflectors(0)
<a name="l00142"></a>00142       , orthogonal_subspace_dimension(0)
<a name="l00143"></a>00143       , reflector_data(NULL)
<a name="l00144"></a>00144       , coefficient_data(NULL)
<a name="l00145"></a>00145       , swap_data(NULL)
<a name="l00146"></a>00146     { }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     ~<a class="code" href="classNutcracker_1_1ProjectorMatrix.html">ProjectorMatrix</a>() {
<a name="l00149"></a>00149         <span class="keywordflow">if</span>(valid()) {
<a name="l00150"></a>00150             <span class="keyword">delete</span>[] reflector_data;
<a name="l00151"></a>00151             <span class="keyword">delete</span>[] coefficient_data;
<a name="l00152"></a>00152             <span class="keyword">delete</span>[] swap_data;
<a name="l00153"></a>00153         }
<a name="l00154"></a>00154     }
<a name="l00155"></a>00155 
<a name="l00156"></a>00156     <a class="code" href="classNutcracker_1_1ProjectorMatrix.html">ProjectorMatrix</a>(BOOST_RV_REF(<a class="code" href="classNutcracker_1_1ProjectorMatrix.html">ProjectorMatrix</a>) other)
<a name="l00157"></a>00157       : number_of_projectors(<a class="code" href="group__MoveAssistantFunctions.html#ga9b333bbc7e46f1aed11b174ed81dbd4f" title="Returns the value in x, and sets x to zero.">copyAndReset</a>(other.number_of_projectors))
<a name="l00158"></a>00158       , projector_length(<a class="code" href="group__MoveAssistantFunctions.html#ga9b333bbc7e46f1aed11b174ed81dbd4f" title="Returns the value in x, and sets x to zero.">copyAndReset</a>(other.projector_length))
<a name="l00159"></a>00159       , number_of_reflectors(<a class="code" href="group__MoveAssistantFunctions.html#ga9b333bbc7e46f1aed11b174ed81dbd4f" title="Returns the value in x, and sets x to zero.">copyAndReset</a>(other.number_of_reflectors))
<a name="l00160"></a>00160       , orthogonal_subspace_dimension(<a class="code" href="group__MoveAssistantFunctions.html#ga9b333bbc7e46f1aed11b174ed81dbd4f" title="Returns the value in x, and sets x to zero.">copyAndReset</a>(other.orthogonal_subspace_dimension))
<a name="l00161"></a>00161       , reflector_data(<a class="code" href="group__MoveAssistantFunctions.html#ga9b333bbc7e46f1aed11b174ed81dbd4f" title="Returns the value in x, and sets x to zero.">copyAndReset</a>(other.reflector_data))
<a name="l00162"></a>00162       , coefficient_data(<a class="code" href="group__MoveAssistantFunctions.html#ga9b333bbc7e46f1aed11b174ed81dbd4f" title="Returns the value in x, and sets x to zero.">copyAndReset</a>(other.coefficient_data))
<a name="l00163"></a>00163       , swap_data(<a class="code" href="group__MoveAssistantFunctions.html#ga9b333bbc7e46f1aed11b174ed81dbd4f" title="Returns the value in x, and sets x to zero.">copyAndReset</a>(other.swap_data))
<a name="l00164"></a>00164     { }
<a name="l00165"></a>00165 
<a name="l00166"></a>00166     <a class="code" href="classNutcracker_1_1ProjectorMatrix.html">ProjectorMatrix</a>(
<a name="l00167"></a>00167           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> number_of_projectors
<a name="l00168"></a>00168         , <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> projector_length
<a name="l00169"></a>00169         , <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> number_of_reflectors
<a name="l00170"></a>00170         , <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> orthogonal_subspace_dimension
<a name="l00171"></a>00171         , complex&lt;double&gt;* reflector_data
<a name="l00172"></a>00172         , complex&lt;double&gt;* coefficient_data
<a name="l00173"></a>00173         , uint32_t* swap_data
<a name="l00174"></a>00174     ) : number_of_projectors(number_of_projectors)
<a name="l00175"></a>00175       , projector_length(projector_length)
<a name="l00176"></a>00176       , number_of_reflectors(number_of_reflectors)
<a name="l00177"></a>00177       , orthogonal_subspace_dimension(orthogonal_subspace_dimension)
<a name="l00178"></a>00178       , reflector_data(reflector_data)
<a name="l00179"></a>00179       , coefficient_data(coefficient_data)
<a name="l00180"></a>00180       , swap_data(swap_data)
<a name="l00181"></a>00181     { }
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     <a class="code" href="classNutcracker_1_1ProjectorMatrix.html">ProjectorMatrix</a>&amp; operator=(BOOST_RV_REF(<a class="code" href="classNutcracker_1_1ProjectorMatrix.html">ProjectorMatrix</a>) other) {
<a name="l00184"></a>00184         <span class="keywordflow">if</span>(<span class="keyword">this</span> == &amp;other) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00185"></a>00185         number_of_projectors = <a class="code" href="group__MoveAssistantFunctions.html#ga9b333bbc7e46f1aed11b174ed81dbd4f" title="Returns the value in x, and sets x to zero.">copyAndReset</a>(other.number_of_projectors);
<a name="l00186"></a>00186         projector_length = <a class="code" href="group__MoveAssistantFunctions.html#ga9b333bbc7e46f1aed11b174ed81dbd4f" title="Returns the value in x, and sets x to zero.">copyAndReset</a>(other.projector_length);
<a name="l00187"></a>00187         number_of_reflectors = <a class="code" href="group__MoveAssistantFunctions.html#ga9b333bbc7e46f1aed11b174ed81dbd4f" title="Returns the value in x, and sets x to zero.">copyAndReset</a>(other.number_of_reflectors);
<a name="l00188"></a>00188         orthogonal_subspace_dimension = <a class="code" href="group__MoveAssistantFunctions.html#ga9b333bbc7e46f1aed11b174ed81dbd4f" title="Returns the value in x, and sets x to zero.">copyAndReset</a>(other.orthogonal_subspace_dimension);
<a name="l00189"></a>00189         <a class="code" href="group__MoveAssistantFunctions.html#ga06d627609aada722be15524bb44f3622" title="Deallocates the array at to (if to is non-null), copies the pointer from from to to, and then sets from to null.">moveArrayToFrom</a>(reflector_data,other.reflector_data);
<a name="l00190"></a>00190         <a class="code" href="group__MoveAssistantFunctions.html#ga06d627609aada722be15524bb44f3622" title="Deallocates the array at to (if to is non-null), copies the pointer from from to to, and then sets from to null.">moveArrayToFrom</a>(coefficient_data,other.coefficient_data);
<a name="l00191"></a>00191         <a class="code" href="group__MoveAssistantFunctions.html#ga06d627609aada722be15524bb44f3622" title="Deallocates the array at to (if to is non-null), copies the pointer from from to to, and then sets from to null.">moveArrayToFrom</a>(swap_data,other.swap_data);
<a name="l00192"></a>00192         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00193"></a>00193     }
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     <span class="keywordtype">void</span> swap(<a class="code" href="classNutcracker_1_1ProjectorMatrix.html">ProjectorMatrix</a>&amp; other) {
<a name="l00196"></a>00196         <span class="keywordflow">if</span>(<span class="keyword">this</span> == &amp;other) <span class="keywordflow">return</span>;
<a name="l00197"></a>00197         std::swap(number_of_projectors,other.number_of_projectors);
<a name="l00198"></a>00198         std::swap(projector_length,other.projector_length);
<a name="l00199"></a>00199         std::swap(number_of_reflectors,other.number_of_reflectors);
<a name="l00200"></a>00200         std::swap(orthogonal_subspace_dimension,other.orthogonal_subspace_dimension);
<a name="l00201"></a>00201         std::swap(reflector_data,other.reflector_data);
<a name="l00202"></a>00202         std::swap(coefficient_data,other.coefficient_data);
<a name="l00203"></a>00203         std::swap(swap_data,other.swap_data);
<a name="l00204"></a>00204     }
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numberOfProjectors()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> number_of_projectors; }
<a name="l00207"></a>00207     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> projectorLength()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> projector_length; }
<a name="l00208"></a>00208     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numberOfReflectors()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> number_of_reflectors; }
<a name="l00209"></a>00209     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> orthogonalSubspaceDimension()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> orthogonal_subspace_dimension; }
<a name="l00210"></a>00210 
<a name="l00211"></a>00211     complex&lt;double&gt;* reflectorData() { <span class="keywordflow">if</span>(invalid()) <span class="keywordflow">throw</span> <a class="code" href="structNutcracker_1_1InvalidTensorException.html">InvalidTensorException</a>(); <span class="keywordflow">return</span> reflector_data; }
<a name="l00212"></a>00212     complex&lt;double&gt; <span class="keyword">const</span>* reflectorData()<span class="keyword"> const </span>{ <span class="keywordflow">if</span>(invalid()) <span class="keywordflow">throw</span> <a class="code" href="structNutcracker_1_1InvalidTensorException.html">InvalidTensorException</a>(); <span class="keywordflow">return</span> reflector_data; }
<a name="l00213"></a>00213 
<a name="l00214"></a>00214     complex&lt;double&gt;* coefficientData() { <span class="keywordflow">if</span>(!*<span class="keyword">this</span>) <span class="keywordflow">throw</span> <a class="code" href="structNutcracker_1_1InvalidTensorException.html">InvalidTensorException</a>(); <span class="keywordflow">return</span> coefficient_data; }
<a name="l00215"></a>00215     complex&lt;double&gt; <span class="keyword">const</span>* coefficientData()<span class="keyword"> const </span>{ <span class="keywordflow">if</span>(invalid()) <span class="keywordflow">throw</span> <a class="code" href="structNutcracker_1_1InvalidTensorException.html">InvalidTensorException</a>(); <span class="keywordflow">return</span> coefficient_data; }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217     uint32_t* swapData() { <span class="keywordflow">if</span>(invalid()) <span class="keywordflow">throw</span> <a class="code" href="structNutcracker_1_1InvalidTensorException.html">InvalidTensorException</a>(); <span class="keywordflow">return</span> swap_data; }
<a name="l00218"></a>00218     uint32_t <span class="keyword">const</span>* swapData()<span class="keyword"> const </span>{ <span class="keywordflow">if</span>(invalid()) <span class="keywordflow">throw</span> <a class="code" href="structNutcracker_1_1InvalidTensorException.html">InvalidTensorException</a>(); <span class="keywordflow">return</span> swap_data; }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     <span class="keywordtype">bool</span> valid()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> reflector_data &amp;&amp; coefficient_data &amp;&amp; swap_data; }
<a name="l00221"></a>00221     <span class="keywordtype">bool</span> invalid()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !valid(); }
<a name="l00222"></a>00222 
<a name="l00223"></a>00223     operator bool()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> valid(); }
<a name="l00224"></a>00224 
<a name="l00225"></a>00225     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> operator|(<a class="code" href="classNutcracker_1_1StateSiteAny.html">StateSiteAny</a> <span class="keyword">const</span>&amp; state_site)<span class="keyword"> const </span>{
<a name="l00226"></a>00226         <span class="keywordflow">return</span> connectDimensions(
<a name="l00227"></a>00227              <span class="stringliteral">&quot;state site size&quot;</span>
<a name="l00228"></a>00228             ,state_site.<a class="code" href="classNutcracker_1_1BaseTensor.html#ac358a04f7073bb01ca5401324974b254" title="Returns the size of the data.">size</a>()
<a name="l00229"></a>00229             ,<span class="stringliteral">&quot;projector length&quot;</span>
<a name="l00230"></a>00230             ,projectorLength()
<a name="l00231"></a>00231         );
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233 };
<a name="l00234"></a>00234 <span class="comment">//@+node:gcross.20110220182654.2072: *3* ProjectorSite</span>
<a name="l00235"></a>00235 <span class="comment">//@+&lt;&lt; Description &gt;&gt;</span>
<a name="l00236"></a>00236 <span class="comment">//@+node:gcross.20110429225820.2559: *4* &lt;&lt; Description &gt;&gt;</span>
<a name="l00238"></a>00238 <span class="comment"></span>
<a name="l00243"></a>00243 <span class="comment">//@-&lt;&lt; Description &gt;&gt;</span>
<a name="l00244"></a><a class="code" href="classNutcracker_1_1ProjectorSite.html">00244</a> <span class="keyword">class </span><a class="code" href="classNutcracker_1_1ProjectorSite.html" title="A projector site contains a left-, middle-, and right- normalized version of the same overlap site...">ProjectorSite</a> {
<a name="l00245"></a>00245     <span class="comment">//@+others</span>
<a name="l00246"></a>00246     <span class="comment">//@+node:gcross.20110429225820.2560: *4* [Move support]</span>
<a name="l00247"></a>00247     <span class="keyword">private</span>:
<a name="l00248"></a>00248 
<a name="l00249"></a>00249     BOOST_MOVABLE_BUT_NOT_COPYABLE(<a class="code" href="classNutcracker_1_1ProjectorSite.html" title="A projector site contains a left-, middle-, and right- normalized version of the same overlap site...">ProjectorSite</a>)
<a name="l00250"></a>00250     <span class="comment">//@+node:gcross.20110429225820.2561: *4* Assignment</span>
<a name="l00253"></a>00253 <span class="comment"></span>
<a name="l00254"></a>00254     <span class="keyword">public</span>:
<a name="l00255"></a>00255 
<a name="l00257"></a><a class="code" href="classNutcracker_1_1ProjectorSite.html#a12a8690d3ac688d04897e4979e6acb4c">00257</a>     <span class="keywordtype">void</span> <a class="code" href="classNutcracker_1_1ProjectorSite.html#a12a8690d3ac688d04897e4979e6acb4c" title="Moves the overlap site tensors from other to this and invalidates other.">operator=</a>(BOOST_RV_REF(<a class="code" href="classNutcracker_1_1ProjectorSite.html" title="A projector site contains a left-, middle-, and right- normalized version of the same overlap site...">ProjectorSite</a>) other) {
<a name="l00258"></a>00258         left = boost::move(other.left);
<a name="l00259"></a>00259         middle = boost::move(other.middle);
<a name="l00260"></a>00260         right = boost::move(other.right);
<a name="l00261"></a>00261     }
<a name="l00262"></a>00262 
<a name="l00264"></a><a class="code" href="classNutcracker_1_1ProjectorSite.html#a3c1f9e1764fd7888c8e70586b11feb7e">00264</a>     <span class="keywordtype">void</span> <a class="code" href="classNutcracker_1_1ProjectorSite.html#a3c1f9e1764fd7888c8e70586b11feb7e" title="Swaps the overlap site tensors between this and other.">swap</a>(<a class="code" href="classNutcracker_1_1ProjectorSite.html" title="A projector site contains a left-, middle-, and right- normalized version of the same overlap site...">ProjectorSite</a>&amp; other) {
<a name="l00265"></a>00265         left.<a class="code" href="classNutcracker_1_1OverlapSite.html#ab5d4cfedb46a97e5bafc5266976f6b6b" title="Swaps the data (and dimensions) in other and this.">swap</a>(other.left);
<a name="l00266"></a>00266         middle.<a class="code" href="classNutcracker_1_1OverlapSite.html#ab5d4cfedb46a97e5bafc5266976f6b6b" title="Swaps the data (and dimensions) in other and this.">swap</a>(other.middle);
<a name="l00267"></a>00267         right.<a class="code" href="classNutcracker_1_1OverlapSite.html#ab5d4cfedb46a97e5bafc5266976f6b6b" title="Swaps the data (and dimensions) in other and this.">swap</a>(other.right);
<a name="l00268"></a>00268     }
<a name="l00269"></a>00269 
<a name="l00271"></a>00271     <span class="comment">//@+node:gcross.20110429225820.2562: *4* Constructors</span>
<a name="l00273"></a>00273 <span class="comment"></span>
<a name="l00275"></a>00275 
<a name="l00276"></a>00276     <span class="keyword">public</span>:
<a name="l00277"></a>00277 
<a name="l00279"></a><a class="code" href="classNutcracker_1_1ProjectorSite.html#aad1794287ffaaab5835f1f37edb6ce3a">00279</a>     <a class="code" href="classNutcracker_1_1ProjectorSite.html#aad1794287ffaaab5835f1f37edb6ce3a" title="Construct an invalid projector site (presumably into which you will eventually move data from elsewhe...">ProjectorSite</a>() {}
<a name="l00280"></a>00280 
<a name="l00282"></a><a class="code" href="classNutcracker_1_1ProjectorSite.html#ac237b9501e062881af46c4b9f00e410e">00282</a>     <a class="code" href="classNutcracker_1_1ProjectorSite.html#aad1794287ffaaab5835f1f37edb6ce3a" title="Construct an invalid projector site (presumably into which you will eventually move data from elsewhe...">ProjectorSite</a>(BOOST_RV_REF(<a class="code" href="classNutcracker_1_1ProjectorSite.html" title="A projector site contains a left-, middle-, and right- normalized version of the same overlap site...">ProjectorSite</a>) other)
<a name="l00283"></a>00283       : left(boost::move(other.left))
<a name="l00284"></a>00284       , middle(boost::move(other.middle))
<a name="l00285"></a>00285       , right(boost::move(other.right))
<a name="l00286"></a>00286     { }
<a name="l00287"></a>00287 
<a name="l00289"></a><a class="code" href="classNutcracker_1_1ProjectorSite.html#a4b236a3b1b7c4689de43ba706689a8f7">00289</a>     <a class="code" href="classNutcracker_1_1ProjectorSite.html#aad1794287ffaaab5835f1f37edb6ce3a" title="Construct an invalid projector site (presumably into which you will eventually move data from elsewhe...">ProjectorSite</a>(
<a name="l00290"></a>00290           BOOST_RV_REF(<a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;Left&gt;</a>) left
<a name="l00291"></a>00291         , BOOST_RV_REF(<a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;Middle&gt;</a>) middle
<a name="l00292"></a>00292         , BOOST_RV_REF(<a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;Right&gt;</a>) right
<a name="l00293"></a>00293     ) : left(left)
<a name="l00294"></a>00294       , middle(middle)
<a name="l00295"></a>00295       , right(right)
<a name="l00296"></a>00296     { }
<a name="l00297"></a>00297 
<a name="l00299"></a>00299     <span class="comment">//@+node:gcross.20110429225820.2563: *4* Fields</span>
<a name="l00300"></a>00300     <span class="keyword">private</span>:
<a name="l00301"></a>00301 
<a name="l00302"></a>00302     <a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;Left&gt;</a> left;
<a name="l00303"></a>00303     <a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;Middle&gt;</a> middle;
<a name="l00304"></a>00304     <a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;Right&gt;</a> right;
<a name="l00305"></a>00305     <span class="comment">//@+node:gcross.20110429225820.2564: *4* Miscellaneous</span>
<a name="l00307"></a>00307 <span class="comment"></span>
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <span class="keyword">public</span>:
<a name="l00311"></a>00311 
<a name="l00313"></a>00313 
<a name="l00317"></a><a class="code" href="classNutcracker_1_1ProjectorSite.html#a2a1b4a1eda69b471a57f51705e7b3bd2">00317</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> s<span class="keywordtype">id</span>e&gt; <a class="code" href="classNutcracker_1_1OverlapSite.html">OverlapSite&lt;side&gt;</a> <span class="keyword">const</span>&amp; <span class="keyword">get</span>() <span class="keyword">const</span> {
<a name="l00318"></a>00318         <span class="keywordflow">throw</span> <a class="code" href="structNutcracker_1_1BadLabelException.html" title="Exception thrown when an generic symbol is accessed with an invalid type tag.">BadLabelException</a>(<span class="stringliteral">&quot;OverlapSite::get&quot;</span>,<span class="keyword">typeid</span>(side));
<a name="l00319"></a>00319     }
<a name="l00320"></a>00320     <span class="comment">//@-others</span>
<a name="l00321"></a>00321 };
<a name="l00323"></a>00323 <span class="keyword">template</span>&lt;&gt; <span class="keyword">inline</span> OverlapSite&lt;Left&gt; <span class="keyword">const</span>&amp; ProjectorSite::get&lt;Left&gt;() <span class="keyword">const</span> { <span class="keywordflow">return</span> left; }
<a name="l00324"></a>00324 <span class="keyword">template</span>&lt;&gt; <span class="keyword">inline</span> OverlapSite&lt;Middle&gt; <span class="keyword">const</span>&amp; ProjectorSite::get&lt;Middle&gt;() <span class="keyword">const</span> { <span class="keywordflow">return</span> middle; }
<a name="l00325"></a>00325 <span class="keyword">template</span>&lt;&gt; <span class="keyword">inline</span> OverlapSite&lt;Right&gt; <span class="keyword">const</span>&amp; ProjectorSite::get&lt;Right&gt;() <span class="keyword">const</span> { <span class="keywordflow">return</span> right; }
<a name="l00327"></a>00327 <span class="comment">//@+node:gcross.20110213233103.2786: ** Functions</span>
<a name="l00328"></a>00328 StateSite&lt;Middle&gt; applyProjectorMatrix(
<a name="l00329"></a>00329       ProjectorMatrix <span class="keyword">const</span>&amp; projector_matrix
<a name="l00330"></a>00330     , StateSite&lt;Middle&gt; <span class="keyword">const</span>&amp; old_state_site
<a name="l00331"></a>00331 );
<a name="l00332"></a>00332 
<a name="l00333"></a>00333 OverlapSite&lt;Middle&gt; computeOverlapSiteFromStateSite(StateSite&lt;Middle&gt; <span class="keyword">const</span>&amp; state_site);
<a name="l00334"></a>00334 OverlapSite&lt;None&gt; computeOverlapSiteFromStateSite(StateSiteAny <span class="keyword">const</span>&amp; state_site);
<a name="l00335"></a>00335 
<a name="l00336"></a>00336 OverlapSitesFromStateSitesAndNormalizeResult computeOverlapSitesFromStateSitesAndNormalize(
<a name="l00337"></a>00337       StateSite&lt;Middle&gt; <span class="keyword">const</span>&amp; middle_state_site
<a name="l00338"></a>00338      ,StateSite&lt;Right&gt; <span class="keyword">const</span>&amp; right_state_site
<a name="l00339"></a>00339 );
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 <span class="keywordtype">double</span> computeOverlapWithProjectors(
<a name="l00342"></a>00342      ProjectorMatrix <span class="keyword">const</span>&amp; projector_matrix
<a name="l00343"></a>00343     ,StateSiteAny <span class="keyword">const</span>&amp; state_site
<a name="l00344"></a>00344 );
<a name="l00345"></a>00345 
<a name="l00346"></a>00346 Projector computeProjectorFromState(State <span class="keyword">const</span>&amp; state);
<a name="l00347"></a>00347 
<a name="l00348"></a>00348 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> minimumBandwidthDimensionForProjectorCount(
<a name="l00349"></a>00349       vector&lt;unsigned int&gt; <span class="keyword">const</span>&amp; physical_dimensions
<a name="l00350"></a>00350     , <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> number_of_projectors
<a name="l00351"></a>00351 );
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 ProjectorMatrix randomProjectorMatrix(
<a name="l00354"></a>00354      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> vector_length
<a name="l00355"></a>00355     ,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> number_of_projectors
<a name="l00356"></a>00356 );
<a name="l00357"></a>00357 
<a name="l00358"></a>00358 
<a name="l00359"></a>00359 <span class="comment">//@+node:gcross.20110216193817.1915: *3* computeProjectorFromStateSites</span>
<a name="l00360"></a>00360 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> StateSiteRightRange&gt;
<a name="l00361"></a>00361 Projector computeProjectorFromStateSites(
<a name="l00362"></a>00362       StateSite&lt;Middle&gt; <span class="keyword">const</span>&amp; first_state_site
<a name="l00363"></a>00363     , StateSiteRightRange <span class="keyword">const</span>&amp; rest_state_sites
<a name="l00364"></a>00364 ) {
<a name="l00365"></a>00365     BOOST_CONCEPT_ASSERT((SinglePassRangeConcept&lt;StateSiteRightRange const&gt;));
<a name="l00366"></a>00366     Projector projector;
<a name="l00367"></a>00367     StateSite&lt;Middle&gt; current_state_site(<a class="code" href="group__ConstructorParameters.html#gafd335eeb0a9be2f542e8410546ed570a" title="A convenience function for wrapping values in CopyFrom.">copyFrom</a>(first_state_site));
<a name="l00368"></a>00368     OverlapSite&lt;Right&gt; current_right_overlap_site;
<a name="l00369"></a>00369     BOOST_FOREACH(
<a name="l00370"></a>00370          StateSite&lt;Right&gt; <span class="keyword">const</span>&amp; next_state_site
<a name="l00371"></a>00371         ,rest_state_sites
<a name="l00372"></a>00372     ) {
<a name="l00373"></a>00373         OverlapSitesFromStateSitesAndNormalizeResult result(
<a name="l00374"></a>00374             computeOverlapSitesFromStateSitesAndNormalize(
<a name="l00375"></a>00375                  current_state_site
<a name="l00376"></a>00376                 ,next_state_site
<a name="l00377"></a>00377             )
<a name="l00378"></a>00378         );
<a name="l00379"></a>00379         projector.emplace_back(
<a name="l00380"></a>00380              boost::move(result.left_overlap_site_from_middle_state_site)
<a name="l00381"></a>00381             ,boost::move(result.middle_overlap_site_from_middle_state_site)
<a name="l00382"></a>00382             ,boost::move(current_right_overlap_site)
<a name="l00383"></a>00383         );
<a name="l00384"></a>00384         current_state_site = boost::move(result.middle_state_site_from_right_state_site);
<a name="l00385"></a>00385         current_right_overlap_site = boost::move(result.right_overlap_site_from_right_state_site);
<a name="l00386"></a>00386     }
<a name="l00387"></a>00387     OverlapSite&lt;Left&gt; current_left_overlap_site;
<a name="l00388"></a>00388     OverlapSite&lt;Middle&gt; current_middle_overlap_site(computeOverlapSiteFromStateSite(current_state_site));
<a name="l00389"></a>00389     projector.emplace_back(
<a name="l00390"></a>00390          boost::move(current_left_overlap_site)
<a name="l00391"></a>00391         ,boost::move(current_middle_overlap_site)
<a name="l00392"></a>00392         ,boost::move(current_right_overlap_site)
<a name="l00393"></a>00393     );
<a name="l00394"></a>00394     <span class="keywordflow">return</span> boost::move(projector);
<a name="l00395"></a>00395 }
<a name="l00396"></a>00396 <span class="comment">//@+node:gcross.20110216193817.1918: *3* computeProjectorOverlap</span>
<a name="l00397"></a>00397 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> StateSiteRange&gt;
<a name="l00398"></a>00398 complex&lt;double&gt; computeProjectorOverlap(
<a name="l00399"></a>00399       Projector <span class="keyword">const</span>&amp; projector
<a name="l00400"></a>00400     , StateSiteRange <span class="keyword">const</span>&amp; state_sites
<a name="l00401"></a>00401     , <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> active_site_number=0
<a name="l00402"></a>00402 ) {
<a name="l00403"></a>00403     BOOST_CONCEPT_ASSERT((SinglePassRangeConcept&lt;StateSiteRange const&gt;));
<a name="l00404"></a>00404     OverlapBoundary&lt;Left&gt; left_boundary(<a class="code" href="group__DummyArguments.html#gab348bc87d12559fc5e924286d3e6d6fd" title="The singleton instance of MakeTrivial.">make_trivial</a>);
<a name="l00405"></a>00405     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;
<a name="l00406"></a>00406     BOOST_FOREACH(
<a name="l00407"></a>00407          StateSiteAny <span class="keyword">const</span>&amp; state_site
<a name="l00408"></a>00408         ,state_sites
<a name="l00409"></a>00409     ) {
<a name="l00410"></a>00410         <span class="keywordflow">if</span>(i &lt; active_site_number) {
<a name="l00411"></a>00411             left_boundary =
<a name="l00412"></a>00412                 <a class="code" href="group__BoundaryContractors.html#gaace7a6069dc3e4354c1567122a12ca6e" title="Contracts the state and overlap site tensors into the left boundary.">Unsafe::contractSSLeft</a>(
<a name="l00413"></a>00413                      left_boundary
<a name="l00414"></a>00414                     ,projector[i].get&lt;Left&gt;()
<a name="l00415"></a>00415                     ,state_site
<a name="l00416"></a>00416                 );
<a name="l00417"></a>00417         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(i == active_site_number) {
<a name="l00418"></a>00418             left_boundary =
<a name="l00419"></a>00419                 <a class="code" href="group__BoundaryContractors.html#gaace7a6069dc3e4354c1567122a12ca6e" title="Contracts the state and overlap site tensors into the left boundary.">Unsafe::contractSSLeft</a>(
<a name="l00420"></a>00420                      left_boundary
<a name="l00421"></a>00421                     ,projector[i].get&lt;Middle&gt;()
<a name="l00422"></a>00422                     ,state_site
<a name="l00423"></a>00423                 );
<a name="l00424"></a>00424         } <span class="keywordflow">else</span> {
<a name="l00425"></a>00425             left_boundary =
<a name="l00426"></a>00426                 <a class="code" href="group__BoundaryContractors.html#gaace7a6069dc3e4354c1567122a12ca6e" title="Contracts the state and overlap site tensors into the left boundary.">Unsafe::contractSSLeft</a>(
<a name="l00427"></a>00427                      left_boundary
<a name="l00428"></a>00428                     ,projector[i].get&lt;Right&gt;()
<a name="l00429"></a>00429                     ,state_site
<a name="l00430"></a>00430                 );
<a name="l00431"></a>00431         }
<a name="l00432"></a>00432         ++i;
<a name="l00433"></a>00433     }
<a name="l00434"></a>00434     assert(left_boundary.size() == 1);
<a name="l00435"></a>00435     <span class="keywordflow">return</span> left_boundary[0];
<a name="l00436"></a>00436 }
<a name="l00437"></a>00437 <span class="comment">//@+node:gcross.20110217014932.1923: *3* computeStateOverlap</span>
<a name="l00438"></a>00438 <span class="keyword">template</span>&lt;
<a name="l00439"></a>00439      <span class="keyword">typename</span> StateSiteRange1
<a name="l00440"></a>00440     ,<span class="keyword">typename</span> StateSiteRange2
<a name="l00441"></a>00441 &gt; complex&lt;double&gt; computeStateOverlap(
<a name="l00442"></a>00442       StateSiteRange1 <span class="keyword">const</span>&amp; state_sites_1
<a name="l00443"></a>00443     , StateSiteRange2 <span class="keyword">const</span>&amp; state_sites_2
<a name="l00444"></a>00444 ) {
<a name="l00445"></a>00445     BOOST_CONCEPT_ASSERT((SinglePassRangeConcept&lt;StateSiteRange1 const&gt;));
<a name="l00446"></a>00446     BOOST_CONCEPT_ASSERT((SinglePassRangeConcept&lt;StateSiteRange2 const&gt;));
<a name="l00447"></a>00447     OverlapBoundary&lt;Left&gt; left_boundary(<a class="code" href="group__DummyArguments.html#gab348bc87d12559fc5e924286d3e6d6fd" title="The singleton instance of MakeTrivial.">make_trivial</a>);
<a name="l00448"></a>00448     <span class="keyword">typedef</span> tuple&lt;
<a name="l00449"></a>00449              StateSiteAny <span class="keyword">const</span>&amp;
<a name="l00450"></a>00450             ,StateSiteAny <span class="keyword">const</span>&amp;
<a name="l00451"></a>00451             &gt; StateSiteAnyPair;
<a name="l00452"></a>00452     BOOST_FOREACH(
<a name="l00453"></a>00453          StateSiteAnyPair <span class="keyword">const</span> state_site_pair
<a name="l00454"></a>00454         ,make_pair(
<a name="l00455"></a>00455              make_zip_iterator(make_tuple(state_sites_1.begin(),state_sites_2.begin()))
<a name="l00456"></a>00456             ,make_zip_iterator(make_tuple(state_sites_1.end(),state_sites_2.end()))
<a name="l00457"></a>00457          )
<a name="l00458"></a>00458     ) {
<a name="l00459"></a>00459         OverlapSite&lt;None&gt; overlap_site(computeOverlapSiteFromStateSite(state_site_pair.get&lt;0&gt;()));
<a name="l00460"></a>00460         left_boundary =
<a name="l00461"></a>00461             <a class="code" href="group__BoundaryContractors.html#gaace7a6069dc3e4354c1567122a12ca6e" title="Contracts the state and overlap site tensors into the left boundary.">Unsafe::contractSSLeft</a>(
<a name="l00462"></a>00462                  left_boundary
<a name="l00463"></a>00463                 ,overlap_site
<a name="l00464"></a>00464                 ,state_site_pair.get&lt;1&gt;()
<a name="l00465"></a>00465             );
<a name="l00466"></a>00466     }
<a name="l00467"></a>00467     assert(left_boundary.size() == 1);
<a name="l00468"></a>00468     <span class="keywordflow">return</span> left_boundary[0];
<a name="l00469"></a>00469 }
<a name="l00470"></a>00470 <span class="comment">//@+node:gcross.20110218083552.1928: *3* formProjectorMatrix</span>
<a name="l00471"></a>00471 <span class="keyword">template</span>&lt;
<a name="l00472"></a>00472      <span class="keyword">typename</span> OverlapBoundaryLeftRange
<a name="l00473"></a>00473     ,<span class="keyword">typename</span> OverlapBoundaryRightRange
<a name="l00474"></a>00474     ,<span class="keyword">typename</span> OverlapSiteMiddleRange
<a name="l00475"></a>00475 &gt; ProjectorMatrix formProjectorMatrix(
<a name="l00476"></a>00476      OverlapBoundaryLeftRange <span class="keyword">const</span>&amp; left_boundaries
<a name="l00477"></a>00477     ,OverlapBoundaryRightRange <span class="keyword">const</span>&amp; right_boundaries
<a name="l00478"></a>00478     ,OverlapSiteMiddleRange <span class="keyword">const</span>&amp; overlap_sites
<a name="l00479"></a>00479 ) {
<a name="l00480"></a>00480     BOOST_CONCEPT_ASSERT((RandomAccessRangeConcept&lt;OverlapBoundaryLeftRange const&gt;));
<a name="l00481"></a>00481     BOOST_CONCEPT_ASSERT((RandomAccessRangeConcept&lt;OverlapBoundaryRightRange const&gt;));
<a name="l00482"></a>00482     BOOST_CONCEPT_ASSERT((RandomAccessRangeConcept&lt;OverlapSiteMiddleRange const&gt;));
<a name="l00483"></a>00483     assert(left_boundaries.size() == right_boundaries.size());
<a name="l00484"></a>00484     assert(left_boundaries.size() == (<span class="keywordtype">unsigned</span> int)overlap_sites.size());
<a name="l00485"></a>00485     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> number_of_projectors = left_boundaries.size();
<a name="l00486"></a>00486     <span class="keywordflow">if</span>(number_of_projectors == 0u) <span class="keywordflow">return</span> ProjectorMatrix();
<a name="l00487"></a>00487     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span>
<a name="l00488"></a>00488          state_physical_dimension = overlap_sites.begin()-&gt;physicalDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00489"></a>00489         ,state_left_dimension = left_boundaries.begin()-&gt;stateDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00490"></a>00490         ,state_right_dimension = right_boundaries.begin()-&gt;stateDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00491"></a>00491         ,overlap_vector_length = state_physical_dimension*state_left_dimension*state_right_dimension
<a name="l00492"></a>00492         ,number_of_reflectors = min(overlap_vector_length,number_of_projectors)
<a name="l00493"></a>00493         ;
<a name="l00494"></a>00494     complex&lt;double&gt;* overlap_vectors
<a name="l00495"></a>00495         = <span class="keyword">new</span> complex&lt;double&gt;[number_of_projectors*overlap_vector_length];
<a name="l00496"></a>00496     complex&lt;double&gt;* overlap_vector = overlap_vectors;
<a name="l00497"></a>00497     <span class="keyword">typedef</span> tuple&lt;
<a name="l00498"></a>00498              OverlapBoundary&lt;Left&gt; <span class="keyword">const</span>&amp;
<a name="l00499"></a>00499             ,OverlapBoundary&lt;Right&gt; <span class="keyword">const</span>&amp;
<a name="l00500"></a>00500             ,OverlapSite&lt;Middle&gt; <span class="keyword">const</span>&amp;
<a name="l00501"></a>00501             &gt; OverlapVectorTriplet;
<a name="l00502"></a>00502     BOOST_FOREACH(
<a name="l00503"></a>00503          OverlapVectorTriplet <span class="keyword">const</span> overlap_vector_triplet
<a name="l00504"></a>00504         ,make_pair(
<a name="l00505"></a>00505              make_zip_iterator(make_tuple(
<a name="l00506"></a>00506                  left_boundaries.begin()
<a name="l00507"></a>00507                 ,right_boundaries.begin()
<a name="l00508"></a>00508                 ,overlap_sites.begin()
<a name="l00509"></a>00509              ))
<a name="l00510"></a>00510             ,make_zip_iterator(make_tuple(
<a name="l00511"></a>00511                  left_boundaries.end()
<a name="l00512"></a>00512                 ,right_boundaries.end()
<a name="l00513"></a>00513                 ,overlap_sites.end()
<a name="l00514"></a>00514              ))
<a name="l00515"></a>00515          )
<a name="l00516"></a>00516     ) {
<a name="l00517"></a>00517         OverlapBoundary&lt;Left&gt; <span class="keyword">const</span>&amp; left_boundary = overlap_vector_triplet.get&lt;0&gt;();
<a name="l00518"></a>00518         OverlapBoundary&lt;Right&gt; <span class="keyword">const</span>&amp; right_boundary = overlap_vector_triplet.get&lt;1&gt;();
<a name="l00519"></a>00519         OverlapSite&lt;Middle&gt; <span class="keyword">const</span>&amp; overlap_site = overlap_vector_triplet.get&lt;2&gt;();
<a name="l00520"></a>00520         assert(left_boundary.stateDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>) == state_left_dimension);
<a name="l00521"></a>00521         assert(right_boundary.stateDimension(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>) == state_right_dimension);
<a name="l00522"></a>00522         Core::form_overlap_vector(
<a name="l00523"></a>00523              left_boundary | overlap_site
<a name="l00524"></a>00524             ,overlap_site  | right_boundary
<a name="l00525"></a>00525             ,state_left_dimension
<a name="l00526"></a>00526             ,state_right_dimension
<a name="l00527"></a>00527             ,state_physical_dimension
<a name="l00528"></a>00528             ,left_boundary
<a name="l00529"></a>00529             ,right_boundary
<a name="l00530"></a>00530             ,overlap_site
<a name="l00531"></a>00531             ,overlap_vector
<a name="l00532"></a>00532         );
<a name="l00533"></a>00533         overlap_vector += overlap_vector_length;
<a name="l00534"></a>00534     }
<a name="l00535"></a>00535     complex&lt;double&gt;* coefficients = <span class="keyword">new</span> complex&lt;double&gt;[number_of_reflectors];
<a name="l00536"></a>00536     uint32_t* swaps = <span class="keyword">new</span> uint32_t[number_of_reflectors];
<a name="l00537"></a>00537     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> subspace_dimension =
<a name="l00538"></a>00538     Core::convert_vectors_to_reflectors(
<a name="l00539"></a>00539          overlap_vector_length
<a name="l00540"></a>00540         ,number_of_projectors
<a name="l00541"></a>00541         ,overlap_vectors
<a name="l00542"></a>00542         ,coefficients
<a name="l00543"></a>00543         ,swaps
<a name="l00544"></a>00544     );
<a name="l00545"></a>00545     <span class="keywordflow">return</span> ProjectorMatrix(
<a name="l00546"></a>00546              number_of_projectors
<a name="l00547"></a>00547             ,overlap_vector_length
<a name="l00548"></a>00548             ,number_of_reflectors
<a name="l00549"></a>00549             ,overlap_vector_length-subspace_dimension
<a name="l00550"></a>00550             ,overlap_vectors
<a name="l00551"></a>00551             ,coefficients
<a name="l00552"></a>00552             ,swaps
<a name="l00553"></a>00553     );
<a name="l00554"></a>00554 }
<a name="l00555"></a>00555 <span class="comment">//@-others</span>
<a name="l00556"></a>00556 
<a name="l00557"></a>00557 }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559 <span class="preprocessor">#endif</span>
<a name="l00560"></a>00560 <span class="preprocessor"></span><span class="comment">//@-leo</span>
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue May 31 2011 16:30:04 for Nutcracker by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
