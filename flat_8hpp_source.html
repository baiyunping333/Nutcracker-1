<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nutcracker: flat.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script src="http://www.mathjax.org/mathjax/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nutcracker</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>flat.hpp</h1>  </div>
</div>
<div class="contents">
<a href="flat_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//@+leo-ver=5-thin</span>
<a name="l00002"></a>00002 <span class="comment">//@+node:gcross.20110510004855.2218: * @file flat.hpp</span>
<a name="l00003"></a>00003 <span class="comment">//@@language cplusplus</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="comment">//@+&lt;&lt; License &gt;&gt;</span>
<a name="l00006"></a>00006 <span class="comment">//@+node:gcross.20110510004855.2252: ** &lt;&lt; License &gt;&gt;</span>
<a name="l00007"></a>00007 <span class="comment">//@+at</span>
<a name="l00008"></a>00008 <span class="comment">// Copyright (c) 2011, Gregory Crosswhite</span>
<a name="l00009"></a>00009 <span class="comment">// All rights reserved.</span>
<a name="l00010"></a>00010 <span class="comment">// </span>
<a name="l00011"></a>00011 <span class="comment">// Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00012"></a>00012 <span class="comment">// </span>
<a name="l00013"></a>00013 <span class="comment">//     * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00014"></a>00014 <span class="comment">//     * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00015"></a>00015 <span class="comment">// </span>
<a name="l00016"></a>00016 <span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00017"></a>00017 <span class="comment">//@@c</span>
<a name="l00018"></a>00018 <span class="comment">//@-&lt;&lt; License &gt;&gt;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="comment">//@+&lt;&lt; Documentation &gt;&gt;</span>
<a name="l00021"></a>00021 <span class="comment">//@+node:gcross.20110510004855.2220: ** &lt;&lt; Documentation &gt;&gt;</span>
<a name="l00026"></a>00026 <span class="comment"></span><span class="comment">//@-&lt;&lt; Documentation &gt;&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#ifndef NUTCRACKER_FLATTENING_HPP</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">#define NUTCRACKER_FLATTENING_HPP</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00031"></a>00031 <span class="comment">//@+&lt;&lt; Includes &gt;&gt;</span>
<a name="l00032"></a>00032 <span class="comment">//@+node:gcross.20110510004855.2254: ** &lt;&lt; Includes &gt;&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;boost/bind.hpp&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;boost/concept_check.hpp&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;boost/numeric/ublas/vector.hpp&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;boost/range/adaptor/transformed.hpp&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;boost/range/concepts.hpp&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;boost/smart_ptr/scoped_array.hpp&gt;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="core_8hpp.html" title="Core numeric kernels.">core.hpp</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;tensors.hpp&quot;</span>
<a name="l00042"></a>00042 <span class="comment">//@-&lt;&lt; Includes &gt;&gt;</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="keyword">namespace </span>Nutcracker {
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="comment">//@+&lt;&lt; Usings &gt;&gt;</span>
<a name="l00047"></a>00047 <span class="comment">//@+node:gcross.20110510004855.2253: ** &lt;&lt; Usings &gt;&gt;</span>
<a name="l00048"></a>00048 <span class="keyword">using</span> boost::adaptors::transformed;
<a name="l00049"></a>00049 <span class="keyword">using</span> boost::scoped_array;
<a name="l00050"></a>00050 <span class="keyword">using</span> boost::SinglePassRangeConcept;
<a name="l00051"></a>00051 <span class="comment">//@-&lt;&lt; Usings &gt;&gt;</span>
<a name="l00052"></a>00052 
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="comment">//@+others</span>
<a name="l00057"></a>00057 <span class="comment">//@+node:gcross.20110510004855.2269: ** Type aliases</span>
<a name="l00059"></a>00059 <span class="comment"></span><span class="comment">/* This is just a typedef to the vector class provided in the Boost.uBlas library. */</span>
<a name="l00060"></a><a class="code" href="group__Flat.html#ga09e050b6f1b36ee3e2225138d48cf76d">00060</a> <span class="keyword">typedef</span> boost::numeric::ublas::vector&lt;complex&lt;double&gt; &gt; <a class="code" href="group__Flat.html#ga09e050b6f1b36ee3e2225138d48cf76d" title="The flat representation of quantum states.">StateVector</a>;
<a name="l00061"></a>00061 <span class="comment">//@+node:gcross.20110510004855.2249: ** Tensors</span>
<a name="l00062"></a>00062 <span class="comment">//@+node:gcross.20110510004855.2286: *3* class Fragment</span>
<a name="l00063"></a>00063 <span class="comment">//@+&lt;&lt; Description &gt;&gt;</span>
<a name="l00064"></a>00064 <span class="comment">//@+node:gcross.20110510004855.2287: *4* &lt;&lt; Description &gt;&gt;</span>
<a name="l00066"></a>00066 <span class="comment"></span>
<a name="l00075"></a>00075 <span class="comment">//@-&lt;&lt; Description &gt;&gt;</span>
<a name="l00076"></a><a class="code" href="classNutcracker_1_1Fragment.html">00076</a> <span class="keyword">class </span><a class="code" href="classNutcracker_1_1Fragment.html" title="An intermediate result produced when constructing a flattened representation of a state...">Fragment</a> : <span class="keyword">public</span> <a class="code" href="classNutcracker_1_1BaseTensor.html">BaseTensor</a> {
<a name="l00077"></a>00077     <span class="comment">//@+others</span>
<a name="l00078"></a>00078     <span class="comment">//@+node:gcross.20110510004855.2288: *4* [Move support]</span>
<a name="l00079"></a>00079     <span class="keyword">private</span>:
<a name="l00080"></a>00080 
<a name="l00081"></a>00081     BOOST_MOVABLE_BUT_NOT_COPYABLE(<a class="code" href="classNutcracker_1_1Fragment.html" title="An intermediate result produced when constructing a flattened representation of a state...">Fragment</a>)
<a name="l00082"></a>00082     <span class="comment">//@+node:gcross.20110510004855.2289: *4* Assignment</span>
<a name="l00085"></a>00085 <span class="comment"></span>
<a name="l00086"></a>00086     <span class="keyword">protected</span>:
<a name="l00087"></a>00087 
<a name="l00089"></a><a class="code" href="classNutcracker_1_1Fragment.html#a883ac6102f2df16c6bce727c15a8c2db">00089</a>     <span class="keywordtype">void</span> <a class="code" href="classNutcracker_1_1Fragment.html#a883ac6102f2df16c6bce727c15a8c2db" title="Moves the data (and dimensions) from other to this and invalidates other.">operator=</a>(BOOST_RV_REF(<a class="code" href="classNutcracker_1_1Fragment.html" title="An intermediate result produced when constructing a flattened representation of a state...">Fragment</a>) other) {
<a name="l00090"></a>00090         <a class="code" href="classNutcracker_1_1Fragment.html#a883ac6102f2df16c6bce727c15a8c2db" title="Moves the data (and dimensions) from other to this and invalidates other.">BaseTensor::operator=</a>(boost::move(static_cast&lt;BaseTensor&amp;&gt;(other)));
<a name="l00091"></a>00091         physical_dimension = boost::move(other.physical_dimension);
<a name="l00092"></a>00092         right_dimension = boost::move(other.right_dimension);
<a name="l00093"></a>00093     }
<a name="l00094"></a>00094 
<a name="l00096"></a>00096     <span class="comment">//@+node:gcross.20110510004855.2290: *4* Constructors</span>
<a name="l00099"></a>00099 <span class="comment"></span>
<a name="l00100"></a>00100     <span class="keyword">public</span>:
<a name="l00101"></a>00101 
<a name="l00103"></a><a class="code" href="classNutcracker_1_1Fragment.html#acae43281eb8756d644c7a8217efbd6bb">00103</a>     <a class="code" href="classNutcracker_1_1Fragment.html#acae43281eb8756d644c7a8217efbd6bb" title="Construct an invalid tensor (presumably into which you will eventually move data from elsewhere)...">Fragment</a>() {}
<a name="l00104"></a>00104 
<a name="l00106"></a><a class="code" href="classNutcracker_1_1Fragment.html#ad27b903c03152c64c4e89cecc0a9d7b3">00106</a>     <a class="code" href="classNutcracker_1_1Fragment.html#acae43281eb8756d644c7a8217efbd6bb" title="Construct an invalid tensor (presumably into which you will eventually move data from elsewhere)...">Fragment</a>(BOOST_RV_REF(<a class="code" href="classNutcracker_1_1Fragment.html" title="An intermediate result produced when constructing a flattened representation of a state...">Fragment</a>) other)
<a name="l00107"></a>00107       : <a class="code" href="classNutcracker_1_1BaseTensor.html">BaseTensor</a>(boost::move(static_cast&lt;<a class="code" href="classNutcracker_1_1BaseTensor.html">BaseTensor</a>&amp;&gt;(other)))
<a name="l00108"></a>00108       , physical_dimension(boost::move(other.physical_dimension))
<a name="l00109"></a>00109       , right_dimension(boost::move(other.right_dimension))
<a name="l00110"></a>00110     { }
<a name="l00111"></a>00111 
<a name="l00113"></a><a class="code" href="classNutcracker_1_1Fragment.html#a940737772987d2c7e8931463996873fb">00113</a>     <a class="code" href="classNutcracker_1_1Fragment.html#acae43281eb8756d644c7a8217efbd6bb" title="Construct an invalid tensor (presumably into which you will eventually move data from elsewhere)...">Fragment</a>(
<a name="l00114"></a>00114           <a class="code" href="classNutcracker_1_1Dimension.html">PhysicalDimension</a> <span class="keyword">const</span> physical_dimension
<a name="l00115"></a>00115         , <a class="code" href="classNutcracker_1_1Dimension.html">RightDimension</a> <span class="keyword">const</span> right_dimension
<a name="l00116"></a>00116         , <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> <a class="code" href="classNutcracker_1_1BaseTensor.html#ac358a04f7073bb01ca5401324974b254" title="Returns the size of the data.">size</a>
<a name="l00117"></a>00117     ) : <a class="code" href="classNutcracker_1_1BaseTensor.html">BaseTensor</a>(size)
<a name="l00118"></a>00118       , physical_dimension(physical_dimension)
<a name="l00119"></a>00119       , right_dimension(right_dimension)
<a name="l00120"></a>00120     { }
<a name="l00121"></a>00121 
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="classNutcracker_1_1Fragment.html#aec454ea78a94d356737693ff5bd70b34">00124</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> G&gt; <a class="code" href="classNutcracker_1_1Fragment.html#acae43281eb8756d644c7a8217efbd6bb" title="Construct an invalid tensor (presumably into which you will eventually move data from elsewhere)...">Fragment</a>(
<a name="l00125"></a>00125           <a class="code" href="classNutcracker_1_1Dimension.html">PhysicalDimension</a> <span class="keyword">const</span> physical_dimension
<a name="l00126"></a>00126         , <a class="code" href="classNutcracker_1_1Dimension.html">RightDimension</a> <span class="keyword">const</span> right_dimension
<a name="l00127"></a>00127         , <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> <a class="code" href="classNutcracker_1_1BaseTensor.html#ac358a04f7073bb01ca5401324974b254" title="Returns the size of the data.">size</a>
<a name="l00128"></a>00128         , <a class="code" href="structNutcracker_1_1FillWithGenerator.html" title="A parameter wrapper class that indicates a tensor should be constructed using data from a generator...">FillWithGenerator&lt;G&gt;</a> <span class="keyword">const</span> generator
<a name="l00129"></a>00129     ) : <a class="code" href="classNutcracker_1_1BaseTensor.html">BaseTensor</a>(size,generator)
<a name="l00130"></a>00130       , physical_dimension(physical_dimension)
<a name="l00131"></a>00131       , right_dimension(right_dimension)
<a name="l00132"></a>00132     { }
<a name="l00133"></a>00133 
<a name="l00135"></a>00135 
<a name="l00139"></a><a class="code" href="classNutcracker_1_1Fragment.html#ac89dca617e51912b6cebaa9005cf9b01">00139</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Range&gt; <a class="code" href="classNutcracker_1_1Fragment.html#acae43281eb8756d644c7a8217efbd6bb" title="Construct an invalid tensor (presumably into which you will eventually move data from elsewhere)...">Fragment</a>(
<a name="l00140"></a>00140           <a class="code" href="classNutcracker_1_1Dimension.html">PhysicalDimension</a> <span class="keyword">const</span> physical_dimension
<a name="l00141"></a>00141         , <a class="code" href="classNutcracker_1_1Dimension.html">RightDimension</a> <span class="keyword">const</span> right_dimension
<a name="l00142"></a>00142         , <a class="code" href="structNutcracker_1_1FillWithRange.html" title="A parameter wrapper class that indicates a tensor should be constructed using data from a range...">FillWithRange&lt;Range&gt;</a> <span class="keyword">const</span> init
<a name="l00143"></a>00143     ) : <a class="code" href="classNutcracker_1_1BaseTensor.html">BaseTensor</a>(init)
<a name="l00144"></a>00144       , physical_dimension(physical_dimension)
<a name="l00145"></a>00145       , right_dimension(right_dimension)
<a name="l00146"></a>00146     { }
<a name="l00147"></a>00147 
<a name="l00149"></a><a class="code" href="classNutcracker_1_1Fragment.html#a3482c37f63798a02ce9933b2de264e49">00149</a>     <a class="code" href="classNutcracker_1_1Fragment.html#acae43281eb8756d644c7a8217efbd6bb" title="Construct an invalid tensor (presumably into which you will eventually move data from elsewhere)...">Fragment</a>(
<a name="l00150"></a>00150           <a class="code" href="structNutcracker_1_1MakeTrivial.html" title="Dummy class used to specify that a tensor should be constructed as the &amp;quot;trivial&amp;quot; tensor...">MakeTrivial</a> <span class="keyword">const</span> <a class="code" href="group__DummyArguments.html#gab348bc87d12559fc5e924286d3e6d6fd" title="The singleton instance of MakeTrivial.">make_trivial</a>
<a name="l00151"></a>00151     ) : <a class="code" href="classNutcracker_1_1BaseTensor.html">BaseTensor</a>(make_trivial)
<a name="l00152"></a>00152       , physical_dimension(1)
<a name="l00153"></a>00153       , right_dimension(1)
<a name="l00154"></a>00154     { }
<a name="l00155"></a>00155 
<a name="l00157"></a>00157     <span class="comment">//@+node:gcross.20110510004855.2292: *4* Dimension information</span>
<a name="l00160"></a>00160 <span class="comment"></span>
<a name="l00161"></a>00161     <span class="keyword">public</span>:
<a name="l00162"></a>00162 
<a name="l00164"></a><a class="code" href="classNutcracker_1_1Fragment.html#a97671d7d1eb09e93416d7e1bf4c33821">00164</a>     <a class="code" href="classNutcracker_1_1Dimension.html">PhysicalDimension</a> <a class="code" href="classNutcracker_1_1Fragment.html#a97671d7d1eb09e93416d7e1bf4c33821" title="Returns the physical dimension of this tensor.">physicalDimension</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> physical_dimension; }
<a name="l00166"></a><a class="code" href="classNutcracker_1_1Fragment.html#aa03c3b932628cbeeb1d50ddc53b54269">00166</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classNutcracker_1_1Fragment.html#aa03c3b932628cbeeb1d50ddc53b54269" title="Unwraps the physical dimension of this tensor and directly returns an unsigned integer.">physicalDimension</a>(<a class="code" href="structNutcracker_1_1AsUnsignedInteger.html" title="Dummy class used to specify that the integer inside a dimension wrapper class should be unwrapped and...">AsUnsignedInteger</a> _)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *physical_dimension; }
<a name="l00167"></a>00167 
<a name="l00169"></a><a class="code" href="classNutcracker_1_1Fragment.html#ae5f1be64e1f99c542ac04ebd7b95a61c">00169</a>     <a class="code" href="classNutcracker_1_1Dimension.html">RightDimension</a> <a class="code" href="classNutcracker_1_1Fragment.html#ae5f1be64e1f99c542ac04ebd7b95a61c" title="Returns the right dimension of this tensor.">rightDimension</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> right_dimension; }
<a name="l00171"></a><a class="code" href="classNutcracker_1_1Fragment.html#aa9d05aba72f7874cc33943eaca33e4b6">00171</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classNutcracker_1_1Fragment.html#aa9d05aba72f7874cc33943eaca33e4b6" title="Unwraps the right dimension of this tensor and directly returns an unsigned integer.">rightDimension</a>(<a class="code" href="structNutcracker_1_1AsUnsignedInteger.html" title="Dummy class used to specify that the integer inside a dimension wrapper class should be unwrapped and...">AsUnsignedInteger</a> _)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *right_dimension; }
<a name="l00172"></a>00172 
<a name="l00174"></a>00174     <span class="comment">//@+node:gcross.20110510004855.2293: *4* Fields</span>
<a name="l00175"></a>00175     <span class="keyword">private</span>:
<a name="l00176"></a>00176 
<a name="l00178"></a>00178     <a class="code" href="classNutcracker_1_1Dimension.html">PhysicalDimension</a> physical_dimension;
<a name="l00179"></a>00179 
<a name="l00181"></a>00181     <a class="code" href="classNutcracker_1_1Dimension.html">RightDimension</a> right_dimension;
<a name="l00182"></a>00182     <span class="comment">//@+node:gcross.20110510004855.2294: *4* Miscellaneous</span>
<a name="l00183"></a>00183     <span class="keyword">public</span>:
<a name="l00184"></a>00184 
<a name="l00186"></a>00186 
<a name="l00187"></a><a class="code" href="classNutcracker_1_1Fragment.html#afd550223ecdbd9c55016d655834824a5">00187</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classNutcracker_1_1Fragment.html#afd550223ecdbd9c55016d655834824a5" title="Connects this tensor&amp;#39;s right dimension of to the left dimension of state_site.">operator|</a>(<a class="code" href="classNutcracker_1_1StateSiteAny.html">StateSiteAny</a> <span class="keyword">const</span>&amp; state_site)<span class="keyword"> const </span>{
<a name="l00188"></a>00188         <span class="keywordflow">return</span> connectDimensions(
<a name="l00189"></a>00189              <span class="stringliteral">&quot;fragment right&quot;</span>
<a name="l00190"></a>00190             ,<a class="code" href="classNutcracker_1_1Fragment.html#ae5f1be64e1f99c542ac04ebd7b95a61c" title="Returns the right dimension of this tensor.">rightDimension</a>(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00191"></a>00191             ,<span class="stringliteral">&quot;state site left&quot;</span>
<a name="l00192"></a>00192             ,state_site.<a class="code" href="classNutcracker_1_1SiteBaseTensor.html#a50ea3d42d07bfeb78454a8a016d4b6dd" title="Returns the left dimension of this tensor.">leftDimension</a>(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)
<a name="l00193"></a>00193         );
<a name="l00194"></a>00194     }
<a name="l00195"></a>00195     <span class="comment">//@-others</span>
<a name="l00196"></a>00196 };
<a name="l00197"></a>00197 <span class="comment">//@+node:gcross.20110510004855.2236: *3* class StateVectorFragment</span>
<a name="l00198"></a>00198 <span class="comment">//@+&lt;&lt; Description &gt;&gt;</span>
<a name="l00199"></a>00199 <span class="comment">//@+node:gcross.20110510004855.2237: *4* &lt;&lt; Description &gt;&gt;</span>
<a name="l00201"></a>00201 <span class="comment"></span>
<a name="l00212"></a>00212 <span class="comment">//@-&lt;&lt; Description &gt;&gt;</span>
<a name="l00213"></a><a class="code" href="classNutcracker_1_1StateVectorFragment.html">00213</a> <span class="keyword">class </span><a class="code" href="classNutcracker_1_1StateVectorFragment.html" title="An intermediate result of constructing a flat state vector from a matrix product state.">StateVectorFragment</a> : <span class="keyword">public</span> <a class="code" href="classNutcracker_1_1Fragment.html" title="An intermediate result produced when constructing a flattened representation of a state...">Fragment</a> {
<a name="l00214"></a>00214     <span class="comment">//@+others</span>
<a name="l00215"></a>00215     <span class="comment">//@+node:gcross.20110510004855.2238: *4* [Move support]</span>
<a name="l00216"></a>00216     <span class="keyword">private</span>:
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     BOOST_MOVABLE_BUT_NOT_COPYABLE(<a class="code" href="classNutcracker_1_1StateVectorFragment.html" title="An intermediate result of constructing a flat state vector from a matrix product state.">StateVectorFragment</a>)
<a name="l00219"></a>00219     <span class="comment">//@+node:gcross.20110510004855.2239: *4* Assignment</span>
<a name="l00222"></a>00222 <span class="comment"></span>
<a name="l00223"></a>00223     <span class="keyword">public</span>:
<a name="l00224"></a>00224 
<a name="l00226"></a><a class="code" href="classNutcracker_1_1StateVectorFragment.html#a3972b6e4a9d314462815bc59755b45d8">00226</a>     <a class="code" href="classNutcracker_1_1StateVectorFragment.html" title="An intermediate result of constructing a flat state vector from a matrix product state.">StateVectorFragment</a>&amp; <a class="code" href="classNutcracker_1_1StateVectorFragment.html#a3972b6e4a9d314462815bc59755b45d8" title="Moves the data (and dimensions) from other to this and invalidates other.">operator=</a>(BOOST_RV_REF(<a class="code" href="classNutcracker_1_1StateVectorFragment.html" title="An intermediate result of constructing a flat state vector from a matrix product state.">StateVectorFragment</a>) other) {
<a name="l00227"></a>00227         <span class="keywordflow">if</span>(<span class="keyword">this</span> == &amp;other) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00228"></a>00228         <a class="code" href="classNutcracker_1_1StateVectorFragment.html#a3972b6e4a9d314462815bc59755b45d8" title="Moves the data (and dimensions) from other to this and invalidates other.">Fragment::operator=</a>(boost::move(static_cast&lt;Fragment&amp;&gt;(other)));
<a name="l00229"></a>00229         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00230"></a>00230     }
<a name="l00231"></a>00231 
<a name="l00233"></a>00233     <span class="comment">//@+node:gcross.20110510004855.2240: *4* Constructors</span>
<a name="l00236"></a>00236 <span class="comment"></span>
<a name="l00237"></a>00237     <span class="keyword">public</span>:
<a name="l00238"></a>00238 
<a name="l00240"></a><a class="code" href="classNutcracker_1_1StateVectorFragment.html#aae681d6b9e38b3526121553e0d98b97f">00240</a>     <a class="code" href="classNutcracker_1_1StateVectorFragment.html#aae681d6b9e38b3526121553e0d98b97f" title="Construct an invalid tensor (presumably into which you will eventually move data from elsewhere)...">StateVectorFragment</a>() {}
<a name="l00241"></a>00241 
<a name="l00243"></a><a class="code" href="classNutcracker_1_1StateVectorFragment.html#ae0e8988b234bc6914bf91c5995ad70d9">00243</a>     <a class="code" href="classNutcracker_1_1StateVectorFragment.html#aae681d6b9e38b3526121553e0d98b97f" title="Construct an invalid tensor (presumably into which you will eventually move data from elsewhere)...">StateVectorFragment</a>(BOOST_RV_REF(<a class="code" href="classNutcracker_1_1StateVectorFragment.html" title="An intermediate result of constructing a flat state vector from a matrix product state.">StateVectorFragment</a>) other)
<a name="l00244"></a>00244       : <a class="code" href="classNutcracker_1_1Fragment.html" title="An intermediate result produced when constructing a flattened representation of a state...">Fragment</a>(boost::move(static_cast&lt;<a class="code" href="classNutcracker_1_1Fragment.html" title="An intermediate result produced when constructing a flattened representation of a state...">Fragment</a>&amp;&gt;(other)))
<a name="l00245"></a>00245     { }
<a name="l00246"></a>00246 
<a name="l00248"></a><a class="code" href="classNutcracker_1_1StateVectorFragment.html#ac3a3a9113408e5c9cf233fd3b1a7bb74">00248</a>     <a class="code" href="classNutcracker_1_1StateVectorFragment.html#aae681d6b9e38b3526121553e0d98b97f" title="Construct an invalid tensor (presumably into which you will eventually move data from elsewhere)...">StateVectorFragment</a>(
<a name="l00249"></a>00249           <a class="code" href="classNutcracker_1_1Dimension.html">PhysicalDimension</a> <span class="keyword">const</span> physical_dimension
<a name="l00250"></a>00250         , <a class="code" href="classNutcracker_1_1Dimension.html">RightDimension</a> <span class="keyword">const</span> right_dimension
<a name="l00251"></a>00251     ) : <a class="code" href="classNutcracker_1_1Fragment.html" title="An intermediate result produced when constructing a flattened representation of a state...">Fragment</a>(physical_dimension,right_dimension,(*physical_dimension)*(*right_dimension))
<a name="l00252"></a>00252     { }
<a name="l00253"></a>00253 
<a name="l00255"></a>00255 
<a name="l00256"></a><a class="code" href="classNutcracker_1_1StateVectorFragment.html#a6de0879aaadbf024901236e0510d2809">00256</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> G&gt; <a class="code" href="classNutcracker_1_1StateVectorFragment.html#aae681d6b9e38b3526121553e0d98b97f" title="Construct an invalid tensor (presumably into which you will eventually move data from elsewhere)...">StateVectorFragment</a>(
<a name="l00257"></a>00257           <a class="code" href="classNutcracker_1_1Dimension.html">PhysicalDimension</a> <span class="keyword">const</span> physical_dimension
<a name="l00258"></a>00258         , <a class="code" href="classNutcracker_1_1Dimension.html">RightDimension</a> <span class="keyword">const</span> right_dimension
<a name="l00259"></a>00259         , <a class="code" href="structNutcracker_1_1FillWithGenerator.html" title="A parameter wrapper class that indicates a tensor should be constructed using data from a generator...">FillWithGenerator&lt;G&gt;</a> <span class="keyword">const</span> generator
<a name="l00260"></a>00260     ) : <a class="code" href="classNutcracker_1_1Fragment.html" title="An intermediate result produced when constructing a flattened representation of a state...">Fragment</a>(physical_dimension,right_dimension,(*physical_dimension)*(*right_dimension),generator)
<a name="l00261"></a>00261     { }
<a name="l00262"></a>00262 
<a name="l00264"></a>00264 
<a name="l00268"></a><a class="code" href="classNutcracker_1_1StateVectorFragment.html#ab13b578b3826244378cc29cfae6aa488">00268</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Range&gt; <a class="code" href="classNutcracker_1_1StateVectorFragment.html#aae681d6b9e38b3526121553e0d98b97f" title="Construct an invalid tensor (presumably into which you will eventually move data from elsewhere)...">StateVectorFragment</a>(
<a name="l00269"></a>00269           <a class="code" href="classNutcracker_1_1Dimension.html">PhysicalDimension</a> <span class="keyword">const</span> physical_dimension
<a name="l00270"></a>00270         , <a class="code" href="structNutcracker_1_1FillWithRange.html" title="A parameter wrapper class that indicates a tensor should be constructed using data from a range...">FillWithRange&lt;Range&gt;</a> <span class="keyword">const</span> init
<a name="l00271"></a>00271     ) : <a class="code" href="classNutcracker_1_1Fragment.html" title="An intermediate result produced when constructing a flattened representation of a state...">Fragment</a>(physical_dimension,init.<a class="code" href="classNutcracker_1_1BaseTensor.html#ac358a04f7073bb01ca5401324974b254" title="Returns the size of the data.">size</a>()/(*physical_dimension),init)
<a name="l00272"></a>00272     { }
<a name="l00273"></a>00273 
<a name="l00275"></a><a class="code" href="classNutcracker_1_1StateVectorFragment.html#adc9f63b04ac8d6ebd6208d177b225134">00275</a>     <a class="code" href="classNutcracker_1_1StateVectorFragment.html#aae681d6b9e38b3526121553e0d98b97f" title="Construct an invalid tensor (presumably into which you will eventually move data from elsewhere)...">StateVectorFragment</a>(
<a name="l00276"></a>00276           <a class="code" href="structNutcracker_1_1MakeTrivial.html" title="Dummy class used to specify that a tensor should be constructed as the &amp;quot;trivial&amp;quot; tensor...">MakeTrivial</a> <span class="keyword">const</span> <a class="code" href="group__DummyArguments.html#gab348bc87d12559fc5e924286d3e6d6fd" title="The singleton instance of MakeTrivial.">make_trivial</a>
<a name="l00277"></a>00277     ) : <a class="code" href="classNutcracker_1_1Fragment.html" title="An intermediate result produced when constructing a flattened representation of a state...">Fragment</a>(make_trivial)
<a name="l00278"></a>00278     { }
<a name="l00279"></a>00279 
<a name="l00281"></a>00281     <span class="comment">//@+node:gcross.20110510004855.2241: *4* Casts</span>
<a name="l00283"></a>00283 <span class="comment"></span>
<a name="l00285"></a>00285 
<a name="l00286"></a>00286     <span class="keyword">public</span>:
<a name="l00287"></a>00287 
<a name="l00289"></a><a class="code" href="classNutcracker_1_1StateVectorFragment.html#ab3c378eb354b3b701f8719db92e36e47">00289</a>     <a class="code" href="classNutcracker_1_1StateVectorFragment.html#ab3c378eb354b3b701f8719db92e36e47" title="Casts this tensor to a flat StateVector as long as the right dimension is 1.">operator StateVector</a>()<span class="keyword"> const </span>{
<a name="l00290"></a>00290         assert(<a class="code" href="classNutcracker_1_1Fragment.html#ae5f1be64e1f99c542ac04ebd7b95a61c" title="Returns the right dimension of this tensor.">rightDimension</a>(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>) == 1);
<a name="l00291"></a>00291         <a class="code" href="group__Flat.html#ga09e050b6f1b36ee3e2225138d48cf76d" title="The flat representation of quantum states.">StateVector</a> v(<a class="code" href="classNutcracker_1_1BaseTensor.html#ac358a04f7073bb01ca5401324974b254" title="Returns the size of the data.">size</a>());
<a name="l00292"></a>00292         copy(*<span class="keyword">this</span>,v.data().begin());
<a name="l00293"></a>00293         <span class="keywordflow">return</span> v;
<a name="l00294"></a>00294     }
<a name="l00295"></a>00295 
<a name="l00297"></a>00297     <span class="comment">//@+node:gcross.20110510004855.2244: *4* Miscellaneous</span>
<a name="l00298"></a>00298     <span class="keyword">public</span>:
<a name="l00299"></a>00299 
<a name="l00301"></a><a class="code" href="classNutcracker_1_1StateVectorFragment.html#ae93f9f43de5d97e87f2286432fb790a8">00301</a>     <span class="keyword">static</span> <a class="code" href="classNutcracker_1_1StateVectorFragment.html" title="An intermediate result of constructing a flat state vector from a matrix product state.">StateVectorFragment</a> <span class="keyword">const</span> <a class="code" href="classNutcracker_1_1StateVectorFragment.html#ae93f9f43de5d97e87f2286432fb790a8" title="The trivial state vector fragment tensor with all dimensions one and containing the single value 1...">trivial</a>;
<a name="l00302"></a>00302     <span class="comment">//@-others</span>
<a name="l00303"></a>00303 };
<a name="l00304"></a>00304 <span class="comment">//@+node:gcross.20110510004855.2235: ** Functions</span>
<a name="l00305"></a>00305 <span class="comment">//@+others</span>
<a name="l00306"></a>00306 <span class="comment">//@+node:gcross.20110510004855.2246: *3* computeStateVector</span>
<a name="l00307"></a>00307 <span class="comment">//@+&lt;&lt; Forward declaration of extendStateVectorFragment &gt;&gt;</span>
<a name="l00308"></a>00308 <span class="comment">//@+node:gcross.20110510004855.2268: *4* &lt;&lt; Forward declaration of extendStateVectorFragment &gt;&gt;</span>
<a name="l00309"></a>00309 <a class="code" href="classNutcracker_1_1StateVectorFragment.html" title="An intermediate result of constructing a flat state vector from a matrix product state.">StateVectorFragment</a> <a class="code" href="group__Flat.html#gae08886df6446c6b026adc687807aa8ff" title="Extends a state vector fragement to include another state site tensor.">extendStateVectorFragment</a>(
<a name="l00310"></a>00310       <a class="code" href="classNutcracker_1_1StateVectorFragment.html" title="An intermediate result of constructing a flat state vector from a matrix product state.">StateVectorFragment</a> <span class="keyword">const</span>&amp; old_fragment
<a name="l00311"></a>00311     , <a class="code" href="classNutcracker_1_1StateSiteAny.html">StateSiteAny</a> <span class="keyword">const</span>&amp; state_site
<a name="l00312"></a>00312 );
<a name="l00313"></a>00313 <span class="comment">//@-&lt;&lt; Forward declaration of extendStateVectorFragment &gt;&gt;</span>
<a name="l00314"></a>00314 
<a name="l00316"></a>00316 
<a name="l00324"></a><a class="code" href="group__Flat.html#ga987f6f1c9842c5be4858f272a6daba0e">00324</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> StateSiteRange&gt; <a class="code" href="group__Flat.html#ga09e050b6f1b36ee3e2225138d48cf76d" title="The flat representation of quantum states.">StateVector</a> <a class="code" href="group__Flat.html#ga987f6f1c9842c5be4858f272a6daba0e" title="Computes a flat state vector from a matrx product state represented by a list of state site tensors...">computeStateVector</a>(StateSiteRange <span class="keyword">const</span>&amp; state_sites) {
<a name="l00325"></a>00325     BOOST_CONCEPT_ASSERT((SinglePassRangeConcept&lt;StateSiteRange const&gt;));
<a name="l00326"></a>00326     <a class="code" href="classNutcracker_1_1StateVectorFragment.html" title="An intermediate result of constructing a flat state vector from a matrix product state.">StateVectorFragment</a> current_fragment(<a class="code" href="group__DummyArguments.html#gab348bc87d12559fc5e924286d3e6d6fd" title="The singleton instance of MakeTrivial.">make_trivial</a>);
<a name="l00327"></a>00327     BOOST_FOREACH(<a class="code" href="classNutcracker_1_1StateSiteAny.html">StateSiteAny</a> <span class="keyword">const</span>&amp; state_site, state_sites) {
<a name="l00328"></a>00328         <a class="code" href="classNutcracker_1_1StateVectorFragment.html" title="An intermediate result of constructing a flat state vector from a matrix product state.">StateVectorFragment</a> next_fragment =
<a name="l00329"></a>00329             <a class="code" href="group__Flat.html#gae08886df6446c6b026adc687807aa8ff" title="Extends a state vector fragement to include another state site tensor.">extendStateVectorFragment</a>(
<a name="l00330"></a>00330                  current_fragment
<a name="l00331"></a>00331                 ,state_site
<a name="l00332"></a>00332             );
<a name="l00333"></a>00333         current_fragment = boost::move(next_fragment);
<a name="l00334"></a>00334     }
<a name="l00335"></a>00335     <span class="keywordflow">return</span> current_fragment;
<a name="l00336"></a>00336 }
<a name="l00337"></a>00337 <span class="comment">//@+node:gcross.20110510004855.2267: *3* computeStateVectorComponent</span>
<a name="l00339"></a>00339 <span class="comment"></span>
<a name="l00347"></a><a class="code" href="group__Flat.html#gab31a50af74ed4038f07ba0b1ed7a1719">00347</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> StateSiteRange&gt; complex&lt;double&gt; <a class="code" href="group__Flat.html#gab31a50af74ed4038f07ba0b1ed7a1719" title="Computes the value of a single component of a quantum state given the list of observed qudit values...">computeStateVectorComponent</a>(StateSiteRange <span class="keyword">const</span>&amp; state_sites, vector&lt;unsigned int&gt; <span class="keyword">const</span>&amp; observed_values) {
<a name="l00348"></a>00348     BOOST_CONCEPT_ASSERT((SinglePassRangeConcept&lt;StateSiteRange const&gt;));
<a name="l00349"></a>00349     scoped_array&lt;complex&lt;double&gt; &gt; left_boundary(<span class="keyword">new</span> complex&lt;double&gt;[1]);  left_boundary[0] = c(1,0);
<a name="l00350"></a>00350     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> left_dimension = 1;
<a name="l00351"></a>00351     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;
<a name="l00352"></a>00352     BOOST_FOREACH(<a class="code" href="classNutcracker_1_1StateSiteAny.html">StateSiteAny</a> <span class="keyword">const</span>&amp; state_site, state_sites) {
<a name="l00353"></a>00353         assert(state_site.<a class="code" href="classNutcracker_1_1SiteBaseTensor.html#a50ea3d42d07bfeb78454a8a016d4b6dd" title="Returns the left dimension of this tensor.">leftDimension</a>(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)==left_dimension);
<a name="l00354"></a>00354         complex&lt;double&gt; <span class="keyword">const</span>* <span class="keyword">const</span> transition_matrix = state_site.<a class="code" href="classNutcracker_1_1StateSiteAny.html#a69a74913460b0c4485a1132048477cd3" title="Returns a pointer to the transition matrix for the given observation value.">transitionMatrixForObservation</a>(observed_values[i]);
<a name="l00355"></a>00355         assert(transition_matrix &gt;= state_site.<a class="code" href="classNutcracker_1_1BaseTensor.html#a1aaa03c13bb09360b6424a7fa722a5fb" title="Returns a pointer to the beginning of the data.">begin</a>());
<a name="l00356"></a>00356         assert(transition_matrix &lt; state_site.<a class="code" href="classNutcracker_1_1BaseTensor.html#ae3350c874ec3c43658ff08c39985a2e0" title="Returns a pointer just after the end of the data.">end</a>());
<a name="l00357"></a>00357         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> right_dimension = state_site.<a class="code" href="classNutcracker_1_1SiteBaseTensor.html#ac4ce0e7da3c234e6f644cdd64a1f779e" title="Returns the right dimension of this tensor.">rightDimension</a>(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>);
<a name="l00358"></a>00358         scoped_array&lt;complex&lt;double&gt; &gt; new_left_boundary(<span class="keyword">new</span> complex&lt;double&gt;[right_dimension]);
<a name="l00359"></a>00359         <a class="code" href="group__BLASWrappers.html#ga2159270a9906b0d5f9ac32a521085b65">zgemv</a>(
<a name="l00360"></a>00360             <span class="stringliteral">&quot;N&quot;</span>
<a name="l00361"></a>00361             ,right_dimension,left_dimension
<a name="l00362"></a>00362             ,c(1,0)
<a name="l00363"></a>00363             ,transition_matrix,right_dimension
<a name="l00364"></a>00364             ,left_boundary.get(),1
<a name="l00365"></a>00365             ,c(0,0)
<a name="l00366"></a>00366             ,new_left_boundary.get(),1
<a name="l00367"></a>00367         );
<a name="l00368"></a>00368         left_dimension = right_dimension;
<a name="l00369"></a>00369         left_boundary.swap(new_left_boundary);
<a name="l00370"></a>00370         ++i;
<a name="l00371"></a>00371     }
<a name="l00372"></a>00372     assert(i == observed_values.size() &amp;&amp; <span class="stringliteral">&quot;observed_values vector is larger than the list of state sites&quot;</span>);
<a name="l00373"></a>00373     assert(left_dimension == 1);
<a name="l00374"></a>00374     <span class="keywordflow">return</span> left_boundary[0];
<a name="l00375"></a>00375 }
<a name="l00376"></a>00376 
<a name="l00378"></a>00378 
<a name="l00386"></a><a class="code" href="group__Flat.html#ga1b3330dd605623a406b8b07b7828a63c">00386</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> StateSiteRange&gt; complex&lt;double&gt; <a class="code" href="group__Flat.html#gab31a50af74ed4038f07ba0b1ed7a1719" title="Computes the value of a single component of a quantum state given the list of observed qudit values...">computeStateVectorComponent</a>(StateSiteRange <span class="keyword">const</span>&amp; state_sites, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keyword">const</span> component) {
<a name="l00387"></a>00387     <span class="keywordflow">return</span> <a class="code" href="group__Flat.html#gab31a50af74ed4038f07ba0b1ed7a1719" title="Computes the value of a single component of a quantum state given the list of observed qudit values...">computeStateVectorComponent</a>(state_sites,<a class="code" href="group__Flat.html#ga05b1c5fef522f0c985d54332a3b632f0" title="Converts an integral index of the flat representation of a tensor into the corresponding multi-index ...">flatIndexToTensorIndex</a>(state_sites | transformed(bind(&amp;<a class="code" href="classNutcracker_1_1SiteBaseTensor.html#ad317e981f94e7b24b7798857307ee40d" title="Returns the physical dimension of this tensor.">StateSiteAny::physicalDimension</a>,_1,<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>)),component));
<a name="l00388"></a>00388 }
<a name="l00389"></a>00389 <span class="comment">//@+node:gcross.20110510004855.2247: *3* computeStateVectorLength</span>
<a name="l00391"></a>00391 <span class="comment"></span>
<a name="l00396"></a><a class="code" href="group__Flat.html#ga16bd5b15f05f10d0132b03192c61b9ee">00396</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> StateSiteRange&gt; <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="group__Flat.html#ga16bd5b15f05f10d0132b03192c61b9ee" title="Computes the number of components in the flat vector representation of the state.">computeStateVectorLength</a>(StateSiteRange <span class="keyword">const</span>&amp; state_sites) {
<a name="l00397"></a>00397     BOOST_CONCEPT_ASSERT((SinglePassRangeConcept&lt;StateSiteRange const&gt;));
<a name="l00398"></a>00398     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> length = 1;
<a name="l00399"></a>00399     BOOST_FOREACH(<a class="code" href="classNutcracker_1_1StateSiteAny.html">StateSiteAny</a> <span class="keyword">const</span>&amp; state_site, state_sites) {
<a name="l00400"></a>00400         length *= state_site.<a class="code" href="classNutcracker_1_1SiteBaseTensor.html#ad317e981f94e7b24b7798857307ee40d" title="Returns the physical dimension of this tensor.">physicalDimension</a>(<a class="code" href="group__DummyArguments.html#ga459369c1daac7db1a7a794f684e97f03" title="The singleton instance of AsUnsignedInteger.">as_unsigned_integer</a>);
<a name="l00401"></a>00401     }
<a name="l00402"></a>00402     <span class="keywordflow">return</span> length;
<a name="l00403"></a>00403 }
<a name="l00404"></a>00404 <span class="comment">//@+node:gcross.20110510004855.2255: *3* extendStateVectorFragment</span>
<a name="l00406"></a>00406 <span class="comment"></span>
<a name="l00414"></a>00414 StateVectorFragment <a class="code" href="group__Flat.html#gae08886df6446c6b026adc687807aa8ff" title="Extends a state vector fragement to include another state site tensor.">extendStateVectorFragment</a>(
<a name="l00415"></a>00415       StateVectorFragment <span class="keyword">const</span>&amp; old_fragment
<a name="l00416"></a>00416     , StateSiteAny <span class="keyword">const</span>&amp; state_site
<a name="l00417"></a>00417 );
<a name="l00418"></a>00418 <span class="comment">//@+node:gcross.20110510004855.2274: *3* flatIndexToTensorIndex</span>
<a name="l00420"></a>00420 <span class="comment"></span>
<a name="l00428"></a><a class="code" href="group__Flat.html#ga05b1c5fef522f0c985d54332a3b632f0">00428</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> DimensionRange&gt; vector&lt;unsigned int&gt; <a class="code" href="group__Flat.html#ga05b1c5fef522f0c985d54332a3b632f0" title="Converts an integral index of the flat representation of a tensor into the corresponding multi-index ...">flatIndexToTensorIndex</a>(DimensionRange <span class="keyword">const</span>&amp; dimensions, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> flat_index) {
<a name="l00429"></a>00429     vector&lt;unsigned int&gt; tensor_index;
<a name="l00430"></a>00430     tensor_index.reserve(dimensions.size());
<a name="l00431"></a>00431     BOOST_FOREACH(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> dimension, dimensions | reversed) {
<a name="l00432"></a>00432         tensor_index.push_back(flat_index % dimension);
<a name="l00433"></a>00433         flat_index /= dimension;
<a name="l00434"></a>00434     }
<a name="l00435"></a>00435     assert(flat_index == 0);
<a name="l00436"></a>00436     reverse(tensor_index);
<a name="l00437"></a>00437     <span class="keywordflow">return</span> boost::move(tensor_index);
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 <span class="comment">//@+node:gcross.20110510004855.2275: *3* tensorIndexToFlatIndex</span>
<a name="l00441"></a>00441 <span class="comment"></span>
<a name="l00449"></a><a class="code" href="group__Flat.html#ga1423714e634201264bb2a95f76647d02">00449</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> DimensionRange&gt; <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="group__Flat.html#ga1423714e634201264bb2a95f76647d02" title="Converts a multi-index of the multi-dimensional representation of a tensor into the corresponding int...">tensorIndexToFlatIndex</a>(DimensionRange <span class="keyword">const</span>&amp; dimensions, vector&lt;unsigned int&gt; <span class="keyword">const</span>&amp; tensor_index) {
<a name="l00450"></a>00450     assert(dimensions.size() == tensor_index.size());
<a name="l00451"></a>00451     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> flat_index = 0;
<a name="l00452"></a>00452     BOOST_FOREACH(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">const</span> i, irange(0u,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)dimensions.size())) {
<a name="l00453"></a>00453         assert(tensor_index[i] &lt; dimensions[i]);
<a name="l00454"></a>00454         flat_index *= dimensions[i];
<a name="l00455"></a>00455         flat_index += tensor_index[i];
<a name="l00456"></a>00456     }
<a name="l00457"></a>00457     <span class="keywordflow">return</span> flat_index;
<a name="l00458"></a>00458 }
<a name="l00459"></a>00459 <span class="comment">//@-others</span>
<a name="l00460"></a>00460 <span class="comment">//@-others</span>
<a name="l00461"></a>00461 
<a name="l00463"></a>00463 
<a name="l00464"></a>00464 }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466 <span class="preprocessor">#endif</span>
<a name="l00467"></a>00467 <span class="preprocessor"></span><span class="comment">//@-leo</span>
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue May 31 2011 16:30:04 for Nutcracker by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
